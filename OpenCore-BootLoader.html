<!-- build time:Tue Dec 03 2019 16:26:00 GMT+0800 (中国标准时间) --><!DOCTYPE html><html class="theme-next muse use-motion" lang="zh-CN"><head><meta name="generator" content="Hexo 3.8.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><script src="//cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><link href="/lib/pace/pace-theme-corner-indicator.min.css?v=1.0.2" rel="stylesheet"><meta name="google-site-verification" content="sDeZZSmv4NPbU3sXi1IL5l8PiZt1wVqR5EKUsxOjruY"><link href="//cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" rel="stylesheet" type="text/css"><link href="https://fonts.loli.net/css?family=Noto Serif SC:300,300italic,400,400italic,700,700italic|Noto Serif SC:300,300italic,400,400italic,700,700italic|Roboto Mono:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css"><link href="//cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"><link href="/css/main.css?v=6.6.0" rel="stylesheet" type="text/css"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.6.0"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=6.6.0"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.6.0"><link rel="mask-icon" href="/images/logo.svg?v=6.6.0" color="#222"><script id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"/",scheme:"Muse",version:"6.6.0",sidebar:{position:"left",display:"hide",offset:12,b2t:!1,scrollpercent:!0,onmobile:!0},fancybox:!0,fastclick:!1,lazyload:!1,tabs:!0,motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},algolia:{applicationID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}}}</script><meta name="description" content="精解 OpenCore教程更新于 2019.11.15, 基于 OpenCore 0.5.3 (2019.11.15) 自编译目前官方版本为 0.5.2由于个人能力有限, 教程中难免会有些疏漏, 这里推荐大家在参阅本教程的同时也阅读以下资料:OpenCore 官方文档 – OpenCore 最权威的资料, 没有之一!!!xjn‘s Blog – xjn 大佬的博客, 对台式机非常友好的教程, 内"><meta name="keywords" content="教程,opencore,OC-little,bootloader"><meta property="og:type" content="article"><meta property="og:title" content="精解OpenCore"><meta property="og:url" content="https://blog.daliansky.net/OpenCore-BootLoader.html"><meta property="og:site_name" content="黑果小兵的部落阁"><meta property="og:description" content="精解 OpenCore教程更新于 2019.11.15, 基于 OpenCore 0.5.3 (2019.11.15) 自编译目前官方版本为 0.5.2由于个人能力有限, 教程中难免会有些疏漏, 这里推荐大家在参阅本教程的同时也阅读以下资料:OpenCore 官方文档 – OpenCore 最权威的资料, 没有之一!!!xjn‘s Blog – xjn 大佬的博客, 对台式机非常友好的教程, 内"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="https://blog.daliansky.net/images/loading.gif"><meta property="og:image" content="https://blog.daliansky.net/images/loading.gif"><meta property="og:image" content="https://blog.daliansky.net/images/loading.gif"><meta property="og:image" content="https://blog.daliansky.net/images/loading.gif"><meta property="og:image" content="https://blog.daliansky.net/images/loading.gif"><meta property="og:image" content="https://blog.daliansky.net/images/loading.gif"><meta property="og:image" content="https://blog.daliansky.net/images/loading.gif"><meta property="og:image" content="https://blog.daliansky.net/images/loading.gif"><meta property="og:image" content="https://blog.daliansky.net/images/loading.gif"><meta property="og:image" content="https://blog.daliansky.net/images/loading.gif"><meta property="og:image" content="https://blog.daliansky.net/images/loading.gif"><meta property="og:updated_time" content="2019-11-21T05:46:12.711Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="精解OpenCore"><meta name="twitter:description" content="精解 OpenCore教程更新于 2019.11.15, 基于 OpenCore 0.5.3 (2019.11.15) 自编译目前官方版本为 0.5.2由于个人能力有限, 教程中难免会有些疏漏, 这里推荐大家在参阅本教程的同时也阅读以下资料:OpenCore 官方文档 – OpenCore 最权威的资料, 没有之一!!!xjn‘s Blog – xjn 大佬的博客, 对台式机非常友好的教程, 内"><meta name="twitter:image" content="https://blog.daliansky.net/images/loading.gif"><link rel="alternate" href="/atom.xml" title="黑果小兵的部落阁" type="application/atom+xml"><link rel="canonical" href="https://blog.daliansky.net/OpenCore-BootLoader.html"><script id="page.configurations">CONFIG.page={sidebar:""}</script><title>精解OpenCore | 黑果小兵的部落阁</title><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-title,.use-motion .comments,.use-motion .menu-item,.use-motion .motion-element,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .logo,.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript></head><body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN"><div class="container sidebar-position-left page-post-detail"><div class="headband"></div><header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-wrapper"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">黑果小兵的部落阁</span> <span class="logo-line-after"><i></i></span></a></div><p class="site-subtitle">Hackintosh安装镜像、教程及经验分享</p></div><div class="site-nav-toggle"><button aria-label="切换导航栏"><span class="btn-bar"></span> <span class="btn-bar"></span> <span class="btn-bar"></span></button></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i><br>首页</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i><br>归档</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i><br>分类</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i><br>标签</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i><br>关于</a></li><li class="menu-item menu-item-search"><a href="javascript:;" class="popup-trigger"><i class="menu-item-icon fa fa-search fa-fw"></i><br>搜索</a></li></ul><div class="site-search"><div class="popup search-popup local-search-popup"><div class="local-search-header clearfix"><span class="search-icon"><i class="fa fa-search"></i> </span><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span><div class="local-search-input-wrapper"><input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input"></div></div><div id="local-search-result"></div></div></div></nav></div></header><a href="https://github.com/daliansky" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewbox="0 0 250 250" style="fill:#222;color:#fff;position:absolute;top:0;border:0;right:0" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"/><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"/></svg></a><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><div id="posts" class="posts-expand"><div class="reading-progress-bar"></div><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://blog.daliansky.net/OpenCore-BootLoader.html"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="黑果小兵"><meta itemprop="description" content="黑果小兵,daliansky,blog.daliansky.net,macOS,Hackintosh,黑苹果,linux"><meta itemprop="image" content="/images/avatar.png"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="黑果小兵的部落阁"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">精解OpenCore</h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><time title="创建时间：2019-06-11 23:06:07" itemprop="dateCreated datePublished" datetime="2019-06-11T23:06:07+08:00">2019-06-11</time> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-calendar-check-o"></i> </span><time title="修改时间：2019-11-21 13:46:12" itemprop="dateModified" datetime="2019-11-21T13:46:12+08:00">2019-11-21</time> </span><span class="post-category"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/教程/" itemprop="url" rel="index"><span itemprop="name">教程</span></a></span> </span><span class="post-meta-divider">|</span> <span class="post-meta-item-icon" title="阅读次数"><i class="fa fa-eye"></i> <span class="busuanzi-value" id="busuanzi_value_page_pv"></span></span><div class="post-symbolscount"><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i> </span><span title="本文字数">29k</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-clock-o"></i> </span><span title="阅读时长">53 分钟</span></div></div></header><div class="post-body" itemprop="articleBody"><h1 id="精解-opencore"><a class="markdownIt-Anchor" href="#精解-opencore"></a> 精解 OpenCore</h1><blockquote><p>教程更新于 2019.11.15, 基于 OpenCore 0.5.3 (2019.11.15) 自编译</p><p>目前官方版本为 0.5.2</p></blockquote><p><strong>由于个人能力有限, 教程中难免会有些疏漏, 这里推荐大家在参阅本教程的同时也阅读以下资料:</strong></p><ol><li><a href="https://github.com/acidanthera/OpenCorePkg/blob/master/Docs/Configuration.pdf" target="_blank" rel="noopener">OpenCore 官方文档</a> – OpenCore 最权威的资料, 没有之一!!!</li><li><a href="https://blog.xjn819.com/?p=543" target="_blank" rel="noopener">xjn‘s Blog</a> – xjn 大佬的博客, 对台式机非常友好的教程, 内存管理写的非常详细</li><li><a href="https://github.com/daliansky/OC-little" target="_blank" rel="noopener">OC-little</a> – 宪武大佬的 OC ACPI 热补丁示例, 非常值得学习</li><li><a href="https://khronokernel-2.gitbook.io/opencore-vanilla-desktop-guide/" target="_blank" rel="noopener">Opencore Vanilla Desktop Guide</a></li></ol><p align="center"><img src="/images/loading.gif" data-original="http://7.daliansky.net/OpenCore/OpenCore.png"></p><h2 id="什么是-opencore"><a class="markdownIt-Anchor" href="#什么是-opencore"></a> 什么是 OpenCore</h2><p>OpenCore<code>(简称 OC)</code> 是一个着眼于未来开源引导工具, 最初诞生于 HermitCrabs 实验室, 现在接手于 Acidanthera, 其目的是创造一个更加严谨的模组化的轻量引导系统。尽管 OpenCore 的主要用途是黑苹果, 它也支持其它操作系统的引导。</p><p>OpenCore 现在处于公测 Beta 阶段, 引导相关功能也已非常稳定, 喜欢折腾的朋友现在已经是动手的时机了。</p><p>这个教程只能作为你探索的起点。请仔细阅读并时刻牢记你的硬件可能有不同的配置要求。</p><h2 id="为什么选择-opencore"><a class="markdownIt-Anchor" href="#为什么选择-opencore"></a> 为什么选择 OpenCore</h2><ol><li>从 2019 年 9 月以后, Acidanthera 开发的内核驱动 (Lilu, AppleALC 等等) **「不再会」**在 Clover 上做兼容性测试</li><li>OpenCore 启动黑苹果 (尤其是 macOS 10.15) 会比 Clover 快不少</li><li>OpenCore 提供强大的排错功能和详细的日志</li><li>OpenCore 更加注重系统的安全性, 提供对 OpenCore 自身引导文件对加密, 同时对文件保险箱 (FileVault) 有更强大的支持, 在未来会支持 UEFI 安全启动</li><li>OpenCore 支持基于 <code>boot.efi</code> 的原生开机快捷键支持</li><li>OpenCore 使用更加先进的方法注入第三方内核扩展驱动 (Kext) 且与此同时不会破坏系统完整性保护</li><li>OpenCore 通过读取启动磁盘设置的 NVRAM 变量, 可以像白苹果一样支持在设置的启动磁盘切换默认引导项</li><li>支持给其它 .efi 驱动或引导工具加入参数</li><li>如下 .efi 驱动被合并入 OpenCore, 未来的开发直接与 OpenCore 绑定, <strong>且不再支持 Clover</strong><ul><li><a href="https://github.com/acidanthera/AptioFixPkg" target="_blank" rel="noopener">AptioMemoryFix</a> 已经被合并入 OpenCore 并将未合并的模组更名为 <code>FwRuntimeVariable.efi</code>, 提供更多可按需求定制 Slide 值计算的 Quirk</li><li><a href="https://github.com/acidanthera/AppleSupportPkg" target="_blank" rel="noopener">AppleGenericInput</a> (原来的 <a href="https://github.com/acidanthera/AptioFixPkg" target="_blank" rel="noopener">AptioInputFix</a>) 为了提高兼容性和 <code>ALT</code> / <code>Command</code> 键的对调已经合并入 OpenCore 并增加了更多的 Quirk</li><li>AppleUiSupport 为了提供更好的 FileVault 体验, 已合并入 OpenCore 并增加了更多的 Quirk</li><li>ApfsDriverLoader 计划在未来合并苹果最新的 APFS 驱动源码并支持 Fusion Drive, 有可能并入 OpenCore</li></ul></li></ol><h3 id="opencore-常见疑问"><a class="markdownIt-Anchor" href="#opencore-常见疑问"></a> OpenCore 常见疑问</h3><ol><li><p><strong>OpenCore 没有精美的主题, 以后会添加吗?</strong></p><ul><li>可能但是短时间内不会有, OpenCore 的开发成员 vit9696 已经声明不会开发官方主题, 但是保留了 GUI 接口, 其他开发者可以自己制作</li><li><strong>OpenCore 自带的 GUI 仅用于 Debug, 正常使用的时候是像白苹果一样隐藏的。</strong></li><li>OpenCore 已经提供了大量可以绕开 GUI 的功能, 将 <code>ShowPicker</code> 设置为 <code>NO</code> 隐藏菜单之后, 可以通过系统自带的启动磁盘设置来切换默认系统, 用苹果原生快捷键来重置 NVRAM 和添加引导表示符, 需要其它功能的时候可以随时按 ESC/Option 调出, <strong>主题存在的意义不大</strong></li></ul></li><li><p><strong>OpenCore 为什么不会为其它操作系统忽略 ACPI 补丁?</strong></p><ul><li>真正正确的 ACPI (DSDT/SSDT) 应当适用于所有的操作系统, 单独为一个操作系统制作 ACPI 是不合理的, 因此 OpenCore 基于 ACPI 标准, 不会在 ACPI 上区别对待操作系统, (OpenCore ACPI 教程正在施工中, 敬请期待)</li></ul></li><li><p><strong>OpenCore 的配置为什么看起来这复杂?</strong></p><ul><li>OpenCore 为了提高兼容性, 为用户开放了更多底层的 Quirk</li><li>OpenCore 现阶段没有可用的非常直观的 GUI 编辑器</li></ul><div class="note success"><blockquote><p>换位思考, 如果用 Xcode 来编辑 Clover 安装包内自带的 Config, OpenCore 的配置就会显得简单明了很多</p><p>OpenCore 很多功能都有且只有一处设置, 但是 Clover 有大量干扰组合</p></blockquote></div></li></ol><h2 id="配置-opencore"><a class="markdownIt-Anchor" href="#配置-opencore"></a> 配置 OpenCore</h2><p>讲了这么多, 终于到真正动手的环节了</p><blockquote><p>由于本文较长, 建议配合博客右下角的目录阅读</p></blockquote><h3 id="准备工作"><a class="markdownIt-Anchor" href="#准备工作"></a> 准备工作</h3><p>我们先来做些简单的准备工作</p><h4 id="推荐-bios-设置"><a class="markdownIt-Anchor" href="#推荐-bios-设置"></a> 推荐 BIOS 设置</h4><ul><li><strong>禁用:</strong></li></ul><table><thead><tr><th style="text-align:center">英文</th><th style="text-align:center">中文</th></tr></thead><tbody><tr><td style="text-align:center">Fast Boot</td><td style="text-align:center">快速启动</td></tr><tr><td style="text-align:center">CFG Lock (MSR 0xE2 write protection)</td><td style="text-align:center">CFG 锁 (MSR 0xE2 写入保护)</td></tr><tr><td style="text-align:center">VT-d</td><td style="text-align:center"><a href="https://zhidao.baidu.com/question/495526512.html" target="_blank" rel="noopener">VT-d</a></td></tr><tr><td style="text-align:center">CSM</td><td style="text-align:center">兼容性支持模块</td></tr><tr><td style="text-align:center">Intel SGX</td><td style="text-align:center">Intel SGX</td></tr></tbody></table><hr><ul><li><strong>启用:</strong></li></ul><table><thead><tr><th style="text-align:center">英文</th><th style="text-align:center">中文</th></tr></thead><tbody><tr><td style="text-align:center">VT-x</td><td style="text-align:center"><a href="https://zhidao.baidu.com/question/495526512.html" target="_blank" rel="noopener">VT-x</a></td></tr><tr><td style="text-align:center">Above 4G decoding</td><td style="text-align:center">大于 4G 地址空间解码</td></tr><tr><td style="text-align:center">Hyper Threading</td><td style="text-align:center">处理器超线程</td></tr><tr><td style="text-align:center">Execute Disable Bit</td><td style="text-align:center">执行禁止位</td></tr><tr><td style="text-align:center">EHCI/XHCI Hand-off</td><td style="text-align:center">接手 EHCI/XHCI 控制</td></tr><tr><td style="text-align:center">OS type: Windows 8.1/10</td><td style="text-align:center">操作系统类型: Windows 8.1/10</td></tr></tbody></table><blockquote><p>将 操作系统类型设置为 <code>Windows 8.1/10</code> 是因为部分主板在 <code>Other</code> 模式下会将系统认作是 Windows 7 从而禁用 UEFI 的某些功能并开启 CSM</p><p>200 系及以后的主板理论上不存在这个问题</p></blockquote><hr><h4 id="下载如下文件"><a class="markdownIt-Anchor" href="#下载如下文件"></a> 下载如下文件</h4><ul><li><p><a href="https://github.com/acidanthera/OpenCorePkg/releases" target="_blank" rel="noopener">OpenCorePkg</a> (建议从 Acidanthera 的官方例子开始构建, 并使用官方 Release, 因为 OpenCore 的配置文件需要不断随着主程序的更新而更新)</p><blockquote><p><a href="https://github.com/williambj1/OpenCore-Factory/blob/master/README_zh-Hans.md" target="_blank" rel="noopener">OpenCore-Factory</a> 提供连续的源码自动编译, 喜欢尝鲜的朋友可以下载, 最新编译为 <a href="https://github.com/williambj1/OpenCore-Factory/releases" target="_blank" rel="noopener"><img src="/images/loading.gif" data-original="https://img.shields.io/github/v/release/williambj1/OpenCore-Factory?color=orange&amp;include_prereleases&amp;label=Release" alt="Release"></a></p></blockquote></li><li><p><a href="https://github.com/acidanthera/MacInfoPkg/releases" target="_blank" rel="noopener">MacInfoPkg</a></p></li><li><p><a href="https://github.com/acidanthera/AppleSupportPkg/releases" target="_blank" rel="noopener">AppleSupportPkg</a></p></li><li><p><strong>Plist 编辑器:</strong></p><ul><li><a href="https://github.com/corpnewt/ProperTree" target="_blank" rel="noopener">ProperTree</a> (基于 Python 的轻量级跨平台 Plist 编辑器, 针对 OpenCore 有优化, Acidanthera 官方推荐)</li><li><s><a href="https://itunes.apple.com/cn/app/xcode/id497799835?mt=12" target="_blank" rel="noopener">Xcode</a></s> (Acidanthera 官方推荐, 但是 Xcode 11 处理 <code>&lt;data&gt;</code> 存在严重问题)</li><li><s>Plist Editor Pro</s> (使用远古 Plist 标准, 会破坏 XML 换行而且不会自动转换 Base64, 可用但是不推荐)</li></ul><div class="note danger"><p><a href="https://github.com/Notiflux/OpenCore-Configurator" target="_blank" rel="noopener">OpenCore Configurator [1]</a>, <a href="https://mackie100projects.altervista.org/opencore-configurator/" target="_blank" rel="noopener">OpenCore Configurator [2]</a> 是两个第三方图形化配置工具, 但是 vit9696 <a href="https://github.com/acidanthera/bugtracker/issues/330#issue-443995585" target="_blank" rel="noopener">声明</a> 不建议使用这些工具因为它们在编辑时会破坏 XML 结构并且会造成一系列未知问题。</p><p><strong>目前:</strong></p><ul><li><p><strong>工具 [1] 已经停止开发。</strong></p></li><li><p><strong>工具 [2] 的开发进度与 OpenCore 开发版持平, 但是程序内依旧存在如下问题</strong></p><ul><li><strong><code>UEFI 驱动安装器</code> 里存在大量与 OpenCore 不兼容的驱动</strong></li><li><strong>DeviceProperties 的 &lt;Integer&gt; 在编辑后会丢失</strong></li><li><strong>还有潜在性 Bug</strong></li></ul><blockquote><p>请自行评估其中的利弊</p></blockquote></li></ul></div></li></ul><hr><h4 id="需要具备的条件"><a class="markdownIt-Anchor" href="#需要具备的条件"></a> 需要具备的条件</h4><ul><li>一个 U 盘</li><li><strong>对黑苹果有一定的知识基础, 至少会自己配置 Clover, 清楚各个 内核驱动 <code>.kext</code> 和 UEFI <code>.efi</code> 驱动的用途, 不清楚可以查看<a href="#%E9%99%84%E5%BD%951----opencore-%E6%94%AF%E6%8C%81%E7%9A%84%E5%86%85%E6%A0%B8%E9%A9%B1%E5%8A%A8-kext-%E5%8F%8A%E5%85%B6%E7%94%A8%E9%80%94">附录[1]</a> 和 <a href="#%E9%99%84%E5%BD%952----uefi-%E9%A9%B1%E5%8A%A8-efi-%E5%8F%8A%E5%85%B6%E7%94%A8%E9%80%94">附录[2]</a></strong></li><li>一个完全精简过的 Clover EFI</li><li>一个正常稳定工作的黑苹果测试平台</li><li>EFI 挂载工具</li></ul><h3 id="创建-usb-启动盘"><a class="markdownIt-Anchor" href="#创建-usb-启动盘"></a> 创建 USB 启动盘</h3><ol><li><p>为了不干扰当前引导工具, 建议单独创建一个 USB 启动盘, 格式化为 GUID 分区图, 分区类型为 macOS 日志式。</p><p><img src="/images/loading.gif" data-original="http://7.daliansky.net/OpenCore/FormatUSB.png" alt="FormatUSB"></p></li><li><p>挂载完 EFI 分区真有意思的部分就「开始了」</p><p><img src="/images/loading.gif" data-original="http://7.daliansky.net/OpenCore/EmptyEFI.png" alt="EmptyEFI"></p></li></ol><h3 id="基础文件夹结构"><a class="markdownIt-Anchor" href="#基础文件夹结构"></a> 基础文件夹结构</h3><ol><li><p>OpenCore 的正确文件结构如下所示</p><p><img src="/images/loading.gif" data-original="http://7.daliansky.net/OpenCore/Structure.png" alt="Structure"></p></li><li><p>现在, 你可以将 <strong>AppleSupportPkg</strong> 和 <strong>VirtualSMC</strong> 中必需的 <code>.efi</code> 驱动程序放入 <code>drivers</code> 文件夹, 将 你的 <code>Kext</code> 和 <code>DSDT/SSDT</code> 放入各自的文件夹中。<strong>请注意, OpenCore 不支持支持列表以外的 UEFI 驱动程序!</strong></p></li><li><p>完成后的效果 (请忽略这些随便放的驱动):</p><p><img src="/images/loading.gif" data-original="http://7.daliansky.net/OpenCore/StructureFilled.png" alt="StructureFilled"></p></li></ol><h4 id="配置思路"><a class="markdownIt-Anchor" href="#配置思路"></a> 配置思路</h4><p>OpenCore 的配置建议遵循从简原则, 先确保能进系统再来增加其它功能 (不进系统功能都是免谈), 变数越少出错的概率也就越低</p><ul><li>内核驱动只保留 <code>Lilu</code>, <code>WhateverGreen</code>, <code>VirtualSMC</code> 和必须依赖才能开机的驱动 (删除 AppleALC, VoodooI2C 等功能性驱动)</li></ul><h3 id="配置-configplist"><a class="markdownIt-Anchor" href="#配置-configplist"></a> 配置 Config.plist</h3><ul><li>请记住 OpenCore 中的 config.plist, 与 Clover 的 config.plist 尽管名称相同但是内容和结构完全不同。<strong>它们不能混合滥用</strong>。</li><li>如果你不清楚某一个项里应该填什么「数据类型」, 请参考 <a href="https://github.com/acidanthera/OpenCorePkg/tree/master/Docs" target="_blank" rel="noopener">OpenCore 官方文档</a></li><li>下面的 <code>Quirk</code> 给的都是推荐值, 请根据自身情况修改</li></ul><blockquote><p>部分未在文中提及的 Quirk 和 参数保留原样</p></blockquote><ol><li><p>复制 <code>Sample.plist</code>, 将副本重命名为 <code>config.plist</code> 并用上文提到的编辑工具打开</p><div class="note danger"><ul><li><strong>如果你打算使用的 SMBIOS 苹果已经停止支持 或者你是用的是戴尔 OEM 笔记本</strong></li><li><strong>请使用 SampleFull.plist 并「认真」补全所有 SMBIOS 信息</strong></li></ul></div><p><img src="/images/loading.gif" data-original="http://7.daliansky.net/OpenCore/ConfigSample.png" alt="ConfigSample"></p></li><li><p>里面<code>躺</code>着所有我们需要配置的子项:</p><ul><li><code>ACPI</code>: 用于加载, 屏蔽和修补 ACPI (DSDT/SSDT) 表</li><li><code>Booter</code>: 用于设置 FwRuntimeServices.efi (Slide 值计算, KASLR)</li><li><code>DeviceProperties</code>: 用于设置 PCI 设备属性, 如英特尔缓冲帧补丁, 声卡 Layout ID</li><li><code>Kernel</code>: 用于说明 OpenCore 的具体加密信息, 配置 Kext 加载顺序以及屏蔽驱动</li><li><code>Misc</code>: OpenCore 的自身设置</li><li><code>NVRAM</code>: 用于注入 NVRAM (如引导标识符和 SIP)</li><li><code>Platforminfo</code>: 用于设置 SMBIOS 机型信息</li><li><code>UEFI</code>: 用于加载 UEFI 驱动以及以何种顺序加载</li></ul><p><strong>#WARNING - 1～5</strong> 是开发者的嘱咐和对 Sample 选择的说明, <em><strong>在删除之前请务必确保你已经阅读并遵守了这些条例</strong></em></p><blockquote><p><strong>Warning - 1:</strong> 这只是一个实例。不要直接拿来开机。</p><p><strong>Warning - 2:</strong> 在用 Config 开机之前, 确保你已经理解 Config 内「每一个项的」的意义</p><p><strong>Warning - 3:</strong> 在大多数情况下, 建议从 Sample.plist 开始配置</p><p><strong>Warning - 4:</strong> SampleFull.plist 用于苹果不再支持的机型 (2011 年或更早)</p></blockquote></li></ol><h3 id="acpi"><a class="markdownIt-Anchor" href="#acpi"></a> ACPI</h3><p><strong>Add:</strong> 你需要把这些而例子里内容修改/创建为你的 <code>EFI/OC/ACPI/</code> 下的文件</p><hr><p><strong>Block:</strong></p><ul><li>禁用某个 ACPI 表, 常用于禁用 <code>DAMR</code> 来关闭 VT-d</li></ul><hr><p><strong>Patch:</strong> 对 DSDT (SSDT) 的内容进行查找和替换</p><hr><p><strong>Quirks:</strong> ACPI 相关设置</p><ul><li><strong>FadtEnableReset:</strong> <code>NO</code><ul><li>在旧硬件上修复重启和关机, 除非需要, 否则不推荐开启</li></ul></li><li><strong>NormalizeHeaders:</strong> <code>NO</code><ul><li>清除 ACPI 头字段, 只有 macOS 10.13 需要</li></ul></li><li><strong>RebaseRegions:</strong> <code>YES</code><ul><li>尝试试探性地重新定位 ACPI 内存区域, <strong>使用自定义 DSDT 则必须开启</strong></li></ul></li><li><strong>ResetHwSig:</strong> <code>NO</code><ul><li>存在重新启动后因无法维持硬件签名而导致从休眠中唤醒的问题的硬件需要开启</li></ul></li><li><strong>ResetLogoStatus:</strong> <code>NO</code><ul><li>无法在有 <code>BGRT</code> 表的系统上显示 OEM Windows 标志的硬件需要开启</li></ul></li></ul><h3 id="booter-启动器"><a class="markdownIt-Anchor" href="#booter-启动器"></a> Booter 启动器</h3><p><strong>MmioWhitelist:</strong> 如果开机卡在 <code>PCI...</code> 可以尝试开启 Item 1 下的 Patch</p><hr><p><strong>Quirks:</strong></p><ul><li><p><strong>AvoidRuntimeDefrag:</strong> <code>YES</code></p><ul><li>开启后会修复 UEFI 的运行服务, 例如日期, 时间, NVRAM, 电源控制等</li></ul></li><li><p><strong>DevirtualiseMmio:</strong> <code>YES</code></p><ul><li>开启后会减少 Stolen 内存占用空间，扩大 <code>Slide = N</code> 值的范围, 适用于大多数主板</li></ul></li><li><p><strong>DisableSingleUser:</strong> <code>NO</code></p><ul><li>开启后会禁止 <code>Cmd + S</code> 和 <code>-s</code> 的使用，使设备更加接近于 T2 白苹果</li></ul></li><li><p><strong>DisableVariableWrite:</strong> <code>NO</code></p><ul><li>开启后会禁止 NVRAM 写入, 在 Z390/HM370 等没有原生 macOS 支持 NVRAM 的主板上需要开启</li></ul></li><li><p><strong>DiscardHibernateMap:</strong> <code>NO</code></p><ul><li>开启后会重用原始休眠内存映射，仅某些旧硬件需要</li></ul></li><li><p><strong>EnableSafeModeSlide:</strong> <code>YES</code></p><ul><li>开启后会允许在安全模式下使用 Slide 值</li></ul></li><li><p><strong>EnableWriteUnprotector:</strong> <code>YES</code></p><ul><li>开启后会在执行期间删除 CR0 寄存器中的写入保护</li></ul></li><li><p><strong>ForceExitBootServices:</strong> <code>NO</code></p><ul><li>开启后会确保 ExitBootServices 即使在 MemoryMap 发生更改时也能调用成功, 除非有必要, <strong>否则请勿使用</strong></li></ul></li><li><p><strong>ProtectCsmRegion:</strong> <code>NO</code></p><ul><li>开启后会用于修复人为制造和睡眠唤醒的问题, AvoidRuntimeDefrag 已经修复了这个问题所以请尽可能避免使用这个 Quirk</li></ul></li><li><p><strong>ProvideCustomSlide:</strong> <code>YES</code></p><ul><li><p>如果 Slide 值存在冲突, 此选项将强制 macOS 执行以下操作:</p><blockquote><p>使用一个伪随机值。 只有在遇到 <code>Only N/256 slide values are usable!</code> 时需要</p></blockquote></li></ul></li><li><p><strong>SetupVirtualMap:</strong> <code>YES</code></p><ul><li>开启后会将 SetVirtualAddresses 调用修复为虚拟地址</li></ul></li><li><p><strong>ShrinkMemoryMap:</strong> <code>NO</code></p><ul><li>有巨大且不兼容内存映射的主板需要开启, 非必须不要使用</li></ul></li></ul><h3 id="deviceproperties-设备属性"><a class="markdownIt-Anchor" href="#deviceproperties-设备属性"></a> DeviceProperties 设备属性</h3><p><strong>不同的设备硬件地址不一样! 你需要先通过 Hackintool 或者 Windows 设备管理器 等工具查看 PCI 设备地址!</strong></p><blockquote><p>此处内容可以用 Hackintool 生成然后直接复制过来, 请提前确保内容和结构无误</p></blockquote><hr><p><strong>Add:</strong> 添加 <code>_DSM</code> 设备属性</p><p><code>PciRoot(0x0)/Pci(0x2,0x0)</code></p><ul><li>注入缓冲帧补丁, 查看 <a href="https://github.com/acidanthera/WhateverGreen/blob/master/Manual/FAQ.IntelHD.cn.md#%E4%BD%BF%E7%94%A8-weg-%E8%87%AA%E5%AE%9A%E4%B9%89-fb-%E5%92%8C-%E7%AB%AF%E5%8F%A3-%E8%A1%A5%E4%B8%81" target="_blank" rel="noopener">此处</a>来确认你需要的缓冲帧补丁</li></ul><p><code>PciRoot(0x0)/Pci(0x1f, 0x3)</code> → <code>Layout-id</code></p><ul><li>应用 AppleALC 音频 Layout ID 注入</li></ul><hr><p><strong>Block:</strong> 用于删除/屏蔽设备属性 (可以删除此项, 大多数情况都用不到)</p><ul><li>这里的设置等同于 Clover 里的 ACPI 重命名 <strong><code>_DSM</code> → <code>XDSM</code> + <code>TgtBridge</code></strong></li></ul><h3 id="kernel-内核"><a class="markdownIt-Anchor" href="#kernel-内核"></a> Kernel 内核</h3><p>这里是指定要加载哪些 Kext 以及仿冒 CPU ID 的地方, 这里的顺序<strong>非常重要</strong>, 所以请确保 <code>Lilu.Kext</code> 始终在第一位! 其他优先级更高的 Kext 为 Lilu 的插件, 如 VirtualSMC, AppleALC, WhateverGreen 等</p><p><strong>Add:</strong></p><ul><li><p><strong>BundlePath</strong></p><ul><li>这里填入 Kext 的名称</li><li>如: <code>Lilu.kext</code></li></ul></li><li><p><strong>Enabled</strong></p><ul><li>控制 Kext 的启用禁用</li></ul></li><li><p><strong>ExecutablePath</strong></p><ul><li><p>隐藏在 kext 中的实际可执行文件的路径，可以通过右键单击并选择 <code>显示包内容</code> 来查看 Kext 的路径。 通常为 <code>Contents/MacOS/(Kext)</code>，但有的时候 <code>Plugin</code> 文件夹下也会有 Kext。</p></li><li><p>如: <code>Contents/MacOS/Lilu</code></p><blockquote><p>空壳 Kext 没有可执行文件 (e.g. USBPorts.kext), 此项留空即可</p></blockquote></li></ul></li><li><p><strong>PlistPath</strong></p><ul><li>隐藏在 Kext 中的 <code>Info.plist</code> 路径</li><li>如: <code>Contents/Info.plist</code></li></ul></li></ul><blockquote><p>VoodooI2C 注入样板 <a href="https://github.com/williambj1/Hackintosh-EFI-Asus-Zephyrus-S-GX531/blob/59a1591c2887161ec972f05dcf017e5ac0e8b032/OpenCore/OC/config.plist#L281-L344" target="_blank" rel="noopener">🚪</a></p><p>VoodooPS2 注入样板 <a href="https://github.com/daliansky/XiaoMi-Pro-Hackintosh/blob/e0cc9839331b1f3b1632f235c5f64779ba419799/EFI/OC/config.plist#L723-L749" target="_blank" rel="noopener">🚪</a> (VoodooPS2Trackpad 和 VoodooPS2Trackpad 以此类推)</p></blockquote><hr><p><strong>Emulate:</strong> 仿冒不支持的 CPU, 例如奔腾和赛扬</p><ul><li><strong>CpuidMask:</strong> 设置为零时，将使用原始 CPU 位<ul><li><code>&lt;Clover_FCPUID_Extended_to_4_bytes_Swapped_Bytes&gt; | 00 00 00 00 | 00 00 00 00 | 00 00 00 00</code></li><li>例如: CPUID <code>0x0306A9</code> 就是 <code>A9 06 03 00 | 00 00 00 00 | 00 00 00 00 | 00 00 00 00</code></li></ul></li><li><strong>CpuidData:</strong> CPU 的被仿冒位<ul><li><code>FF FF FF FF | 00 00 00 00 | 00 00 00 00 | 00 00 00 00</code></li><li>如果需要替换更长的位, 将 <code>00</code> 替换为 <code>FF</code></li></ul></li></ul><hr><p><strong>Block:</strong> 屏蔽系统里的 Kext</p><hr><p><strong>Patch:</strong> 这是你要添加系统内核补丁, Kext 补丁, 和 AMD CPU 补丁的地方。(等同于 Clover 的 KextToPatch 和 KernelToPatch)</p><hr><p><strong>Quirks:</strong></p><ul><li><strong>AppleCpuPmCfgLock:</strong> <code>NO</code><ul><li>如果设备的 CFG-Lock 是开启的状态则需要设置为 <code>YES</code> (尽可能用 Grub 关闭 BIOS 的 CFG-Lock 并避免开启这个 Quirk)</li></ul></li><li><strong>AppleXcpmCfgLock:</strong> <code>NO</code><ul><li>同上</li></ul></li><li><strong>AppleXcpmExtraMsrs:</strong> <code>NO</code><ul><li>禁用奔腾和某些至强等不支持 CPU 所需的多个 MSR 访问</li></ul></li><li><strong>CustomSMBIOSGuid:</strong> <code>NO</code><ul><li>对 UpdateSMBIOSMode 自定义模式执行 GUID 修补, 用于戴尔笔记本电脑 (等同于 Clover 的 <code>DellSMBIOSPatch</code>)</li></ul></li><li><strong>DisbaleIOMapper:</strong> <code>NO</code><ul><li>需要绕过 VT-d 且 BIOS 中禁用时使用</li></ul></li><li><strong>ExternalDiskIcons:</strong> <code>YES</code><ul><li>硬盘图标补丁, macOS 将内部硬盘视为外接硬盘 (黄色) 时使用</li></ul></li><li><strong>LapicKernelPanic:</strong> <code>NO</code><ul><li>禁用由 AP 核心 lapic 中断造成的内核崩溃, 通常用于「惠普电脑」 (等同于 Clover 的 <code>Kernel LAPIC</code>)</li></ul></li><li><strong>PanicNoKextDump:</strong> <code>YES</code><ul><li>在发生内核崩溃时阻止输出 Kext 列表, 提供可供排错参考的崩溃日志</li></ul></li><li><strong>PowerTimeoutKernelPanic:</strong> <code>YES</code><ul><li>修复 macOS Catalina 中由于设备电源状态变化超时而导致的内核崩溃</li></ul></li><li><strong>ThirdPartyTrim:</strong> <code>NO</code><ul><li>为 SSD 启用 TRIM 指令, NVMe SSD 会自动被 macOS 加载因此不需要, SATA SSD 可以在终端执行 <code>sudo trimforce enable</code> 开启</li></ul></li><li><strong>XhciPortLimit:</strong> <code>YES</code><ul><li>这实际上是 15 端口限制补丁, 不建议依赖, 因为这不是 USB 的最佳解决方案。有能力的情况下请选择定制 <a href="https://blog.daliansky.net/Intel-FB-Patcher-tutorial-and-insertion-pose.html#%E5%AE%9A%E5%88%B6usb">USB</a>, 这个选项适用于没有定制 USB 的设备</li></ul></li></ul><h3 id="misc-杂项"><a class="markdownIt-Anchor" href="#misc-杂项"></a> Misc 杂项</h3><p><strong>BlessOverride:</strong> 用于覆盖 Windows <code>bootmgfw.efi</code> 的位置以便识别 Windows 引导项, OpenCore 和 Windows 的引导文件在同一硬盘的同一 ESP 分区下使用</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">▼ Misc                  <span class="tag">&lt;<span class="name">Dictionary</span>&gt;</span></span><br><span class="line">|__ ▼ BlessOverride     <span class="tag">&lt;<span class="name">Array</span>&gt;</span></span><br><span class="line">    |__ Item 0          <span class="tag">&lt;<span class="name">String</span>&gt;</span>          \EFI\Microsoft\Boot\bootmgfw.efi</span><br></pre></td></tr></table></figure><p><strong>Boot:</strong> 引导界面的设置</p><ul><li><p><strong>HibernateMode:</strong> <code>None</code></p><blockquote><p>与系统内的休眠模式配合, 引导进系统会还原休眠前的状态, 这个功能会影响 SSD 寿命, 建议关闭</p></blockquote></li><li><p><strong>HideSelf:</strong> <code>YES</code></p><ul><li>在 OpenCore 的启动选择中隐藏自身 EFI 分区的启动项</li></ul></li><li><p><strong>PollAppleHotKeys:</strong> <code>NO</code></p><ul><li>设置为 <code>YES</code> 后允许在引导过程中使用苹果原生快捷键, 需要与 Quirk <code>KeySupport=Yes</code><strong>「或」</strong><code>UsbKbDxe.efi</code> 结合使用, 具体体验取决于主板固件。常用快捷键组合:<ul><li><code>Cmd + V</code>: 启用 <code>-v</code> 跑码</li><li><code>Cmd + Opt + P + R</code>: 重置 NVRAM</li><li><code>Cmd + R</code>: 启动恢复分区</li><li><code>Cmd + S</code>: 启动至单用户模式</li><li><code>Option / ALT</code>: 在 <code>ShowPicker</code> 设置成 <code>NO</code> 时显示引导项, ALT 不可用时可用 <code>ESC</code> 键代替</li></ul></li></ul></li><li><p><strong>Timeout:</strong> <code>0</code></p><ul><li>设置引导项等待时间</li><li><code>0</code> 为关闭倒计时, 相当于 Clover 的 <code>-1</code> (并不是跳过倒计时)</li></ul></li><li><p><strong>ShowPicker:</strong> <code>YES</code></p><ul><li>显示 OpenCore 的 UI, 用于查看可用引导项</li><li><strong>设置为 <code>NO</code> 可以跳过倒计时</strong>, 和 <code>PollAppleHotKeys=Yes</code> 配合快捷键可以大幅提升体验</li></ul></li><li><p><strong>UsePicker:</strong> <code>YES</code></p><ul><li>使用 OpenCore 的默认 GUI, 如果你希望使用其他 GUI (暂时没有), 则设置为 <code>NO</code></li></ul></li></ul><hr><p><strong>Debug:</strong> Debug 有特殊用途, 除非你知道你在做什么, 否则保持原样</p><ul><li><p><strong>DisableWatchDog:</strong> <code>NO</code></p><ul><li>如果 macOS 在启动时卡在某些地方, 可能需要设置为 <code>YES</code>, 通常用于排除错误干扰</li></ul></li><li><p><strong>DisplayDelay:</strong> <code>0</code></p></li><li><p><strong>DisplayLevel:</strong></p><ul><li><code>2147483714</code> 在屏幕上显示所有 Debug 信息</li><li><code>0</code> 隐藏所有 Debug 信息</li></ul></li><li><p><strong>Target:</strong></p><ul><li><code>0</code>: 关闭日志记录</li><li><code>3</code>: 允许屏幕输出日志</li><li><code>19</code>: 允许屏幕输出 UEFI 变量日志</li><li><code>65</code>: 在 ESP 分区根目录生成日志文件 <code>opencore-YYYY-MM-DD-HHMMSS.txt</code>, 但屏幕上不显示日志</li></ul></li></ul><hr><p><strong>Security:</strong> 安全</p><ul><li><strong>AllowNvramReset:</strong> <code>YES</code><ul><li>允许在引导选择界面和快捷键 <code>Cmd + Opt + P + R</code> 按下时重置 NVRAM</li></ul></li><li><strong>RequireSignature:</strong> <code>NO</code><ul><li>我们不会使用 Vault.plist, 选择禁用</li></ul></li><li><strong>RequireVault:</strong> <code>NO</code><ul><li>我们不会使用 Vault.plist, 选择禁用</li></ul></li><li><strong>ScanPolicy:</strong> <code>0</code><ul><li><code>0</code>: 允许扫描所有可用的硬盘</li></ul></li></ul><hr><p><strong>Tools</strong> 用于运行 OC 调试工具, 例如验证 CFG 锁 (VerifyMsrE2)</p><ul><li><strong>Name</strong><ul><li>OpenCore 启动项中显示的名称</li></ul></li><li><strong>Enabled</strong><ul><li>启用或禁用</li></ul></li><li><strong>Path</strong><ul><li><code>Tools</code> 文件夹下的文件名</li><li>如: <a href="https://github.com/acidanthera/AppleSupportPkg/releases" target="_blank" rel="noopener">VerifyMsrE2.efi</a></li></ul></li></ul><hr><p><strong>Entires:</strong> 用于指定 OpenCore 无法自动找到的无规律引导路径</p><ul><li><strong>Name</strong><ul><li>OpenCore 启动项中显示的名称</li></ul></li><li><strong>Enabled</strong><ul><li>启用或禁用</li></ul></li><li><strong>Path</strong><ul><li>引导磁盘的 PCI 路径，可以通过 <a href="https://github.com/acidanthera/OpenCoreShell" target="_blank" rel="noopener">OpenCoreShell</a> 的 <code>map</code> 命令找到</li><li>如: <code>PciRoot(0x0)/Pci(0x1D,0x4)/Pci(0x0,0x0)/NVMe(0x1,09-63-E3-44-8B-44-1B-00)/HD(1,GPT,11F42760-7AB1-4DB5-924B-D12C52895FA9,0x28,0x64000)/\EFI\Microsoft\Boot\bootmgfw.efi</code></li></ul></li></ul><h3 id="nvram"><a class="markdownIt-Anchor" href="#nvram"></a> NVRAM</h3><p><strong>Add:</strong></p><ul><li><p><strong><a href="https://github.com/erikberglund/AppleNVRAM/blob/master/Apple/4D1EDE05-38C7-4A6A-9CC6-4BCCA8B38C14.md" target="_blank" rel="noopener"><code>4D1EDE05-38C7-4A6A-9CC6-4BCCA8B38C14</code></a></strong></p><ul><li><strong>UIScale:</strong> OpenCore UI 和引导第一阶段缩放<ul><li><code>01:</code> 正常大小</li><li><code>02:</code> HIDPI (使 FileVault 和 苹果标志 在原生 HIDPI 显示器上以正常大小显示)</li></ul></li></ul></li><li><p><strong><a href="https://github.com/erikberglund/AppleNVRAM/blob/master/Apple/7C436110-AB2A-4BBB-A880-FE41995C9F82.md" target="_blank" rel="noopener"><code>7C436110-AB2A-4BBB-A880-FE41995C9F82</code></a></strong></p><ul><li><strong>boot-args:</strong> <code>-v debug=0x100</code> (引导标识符, 更多请查看 <a href="#%E9%99%84%E5%BD%953----%E5%B8%B8%E7%94%A8%E5%86%85%E6%A0%B8%E5%BC%95%E5%AF%BC%E6%A0%87%E8%AF%86%E7%AC%A6%E5%90%88%E9%9B%86">附录[3]</a>)</li><li><strong>csr-active-config:</strong> <code>&lt;00000000&gt;</code> (SIP 设置)<ul><li><code>00000000</code> - SIP 完全开启</li><li><code>30000000</code> - 允许未签名的 Kext 加载并允许写入受保护的文件系统路径</li><li><code>E7030000</code> - SIP 完全关闭</li><li><s><code>67000000</code></s> - 不再推荐使用</li></ul></li><li><strong>nvda_drv:</strong> <code>&lt;&gt;</code><ul><li>设为 <code>31</code> 时启用 NVIDIA WebDrivers</li><li>没有 N 卡可以删除此项</li></ul></li><li><strong>prev-lang:kbd:</strong> <code>&lt;0x7a682d48616e733a323532&gt;</code> (将默认语言设置为简体中文, 留空为英文)</li></ul></li></ul><hr><p><strong>Block:</strong> 强制重写 NVRAM 变量, 由于 <code>Add</code> 不会覆盖 NVRAM 中已经存在的值, <code>boot-args</code> 需要利用此项来刷新</p><blockquote><p>具体工作原理请参考 <a href="https://github.com/acidanthera/bugtracker/issues/575#issuecomment-554522261" target="_blank" rel="noopener">Acidanthera bugtracker #575</a></p></blockquote><hr><p><strong>LegacyEnable:</strong> 允许从 <code>nvram.plist</code> 中读取 NVRAM 变量</p><ul><li>没有原生 NVRAM 的设备设置为 <code>YES</code></li><li>macOS 下硬件 NVRAM 工作「不」正常的设备设置为 <code>YES</code></li><li>macOS 下硬件 NVRAM 工作正常的设备设置为 <code>NO</code></li></ul><hr><p><strong>LegacySchema:</strong></p><ul><li>用于分配 NVRAM 变量, 与 LegacyEnable 配合使用, 下文会有详细讲解</li></ul><h3 id="platforminfo-机型信息"><a class="markdownIt-Anchor" href="#platforminfo-机型信息"></a> PlatformInfo 机型信息</h3><p><strong>Auto:</strong> <code>YES</code> (基于 Generic 部分生成 PlatformInfo, 而不是 DataHub, NVRAM 和 SMBIOS 部分)</p><blockquote><p>OpenCore 提供了大量方法来注入 PlatformInfo, 这里只介绍最简单的自动注入法</p></blockquote><hr><p><strong>Generic:</strong></p><ul><li><strong>SpoofVendor:</strong> <code>YES</code> (仿冒制造商为 Acidanthera 来避免出现冲突)</li><li><strong>SystemUUID:</strong> 填入设备的硬件 UUID 以免造成 Windows 和其它软件的激活问题 (官方不再建议留空)</li><li><strong>MLB:</strong> 用 macserial 读取或生成</li><li><strong>ROM:</strong> <code>&lt;0x############&gt;</code> 可以是任意 6 Byte MAC 地址, 如 <code>0x112233000000</code></li><li><strong>SystemProductName:</strong> 用 macserial 读取或生成</li><li><strong>SystemSerialNumber:</strong> 用 macserial 读取或生成</li></ul><hr><p><strong>UpdateDataHub:</strong> <code>YES</code> (更新 DataHub)</p><hr><p><strong>UpdateNVRAM:</strong> <code>YES</code> (更新 NVRAM)</p><hr><p><strong>UpdateSMBIOS:</strong> <code>YES</code> (更新 SMBIOS)</p><hr><p><strong>UpdateSMBIOSMode:</strong> <code>Create</code> (用新分配的 EfiReservedMemoryType 替换原有的表, 戴尔笔记本需要使用 <code>Custom</code> 并开启 <code>CustomSMBIOSGuid</code>)</p><hr><h4 id="macserial"><a class="markdownIt-Anchor" href="#macserial"></a> macserial</h4><p><strong>使用 macserial 查看原有 PlatformInfo:</strong></p><ol><li><p>打开下载好的 MacInfoPkg</p></li><li><p>找到里面的 <code>macserial</code> 并将其复制到桌面</p></li><li><p>终端输入: <strong>(建议复制粘贴)</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> ~/Desktop</span><br><span class="line"></span><br><span class="line">./macserial | grep -w <span class="string">'Model:\|Valid:\|Hardware UUID:\|ROM:\|MLB:\|Serial Number:'</span> | sed <span class="string">'/ \- /d'</span> | tr -d <span class="string">' '</span> | sed $<span class="string">'s/Model:/SystemProductName:/g'</span> | sed $<span class="string">'s/HardwareUUID:/SystemUUID:/g'</span> | sed $<span class="string">'s/SerialNumber:/SystemSerialNumber:/g'</span> | sed $<span class="string">'s/\:/\: /g'</span></span><br></pre></td></tr></table></figure></li><li><p>此时你现有的 PlatformInfo 就已经列出来了, 对着 Config 对号入座即可</p></li></ol><blockquote><p>如果输出的 <code>Valid</code> 不是 <code>Possibly</code> 说明这个 PlatformInfo 不符合规范, 很有可能无法激活苹果服务, 建议重新生成</p></blockquote><hr><p><strong>使用 macserial 生成新的 PlatformInfo:</strong></p><ol><li><p>如果要生成新的 PlatformInfo 请输入如下命令来列出所有支持的设备型号:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> ~/Desktop</span><br><span class="line"></span><br><span class="line">./macserial -l | grep <span class="string">'Model:'</span> | tr -d <span class="string">' '</span> | sed $<span class="string">'s/Model:/\\- /g'</span></span><br></pre></td></tr></table></figure></li><li><p>然后输入如下命令来生成序列号和 MLB</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./macserial -m &lt;设备型号&gt;</span><br></pre></td></tr></table></figure><blockquote><p>请忽略 <code>&lt;&gt;</code>, 例子: <code>./macserial -m MacBookPro15,3</code></p></blockquote><p>输出的结果中, <strong><code>|</code></strong> 前面的是 <code>序列号 SystemSerialNumber</code>, 后面的是 <code>MLB</code></p></li></ol><h3 id="uefi"><a class="markdownIt-Anchor" href="#uefi"></a> UEFI</h3><p><strong>ConnectDrivers:</strong> <code>YES</code></p><ul><li>强制加载 <code>.efi</code> 驱动程序, 更改为 <code>NO</code> 将自动连接 UEFI 驱动程序, 这样以获得更快的启动速度, 但并非所有驱动程序都可以自行连接, 某些文件系统驱动程序可能无法加载</li></ul><hr><p><strong>Drivers:</strong> 在这里添加你的 <code>.efi</code> 驱动</p><hr><p><strong>Input:</strong></p><ul><li><strong>KeyForgetThreshold:</strong> <code>5</code><ul><li>按住按键后每个键之间的时间间隔 (单位: 毫秒)</li></ul></li><li><strong>KeyMergeTheshold:</strong> <code>2</code><ul><li>按住按键被重置的时间间隔 (单位: 毫秒)</li></ul></li><li><strong>KeySupport:</strong> <code>YES</code><ul><li>开启 OC 的内置键盘支持</li><li>使用 UsbKbDxe.efi 请设置为 <code>NO</code></li></ul></li><li><strong>KeySupportMode:</strong> <code>Auto</code> 键值转换协议模式<ul><li><code>V1</code>: UEFI 旧版输入协议</li><li><code>V2</code>: UEFI 新输入协议</li><li><code>AMI</code>: APTIO 输入协议</li></ul></li><li><strong>KeySwap:</strong> <code>NO</code><ul><li>交换 Command 和 Option 键</li></ul></li><li><strong>PointerSupport:</strong> <code>NO</code><ul><li>修复 UEFI 选择器协议</li></ul></li><li><strong>PointerSupportMode:</strong> <code>留空</code></li><li><strong>TimerResolution:</strong> <code>50000</code><ul><li>固件时钟刷新的频率 (单位: 100纳秒)</li><li>华硕主板为自己的界面使用 <code>60000</code></li><li>苹果使用 <code>100000</code></li></ul></li></ul><hr><p><strong>Protocols:</strong> (协议)</p><ul><li><strong>AppleBootPolicy:</strong> <code>NO</code><ul><li>用于确保虚拟机或旧白苹果上兼容 APFS</li></ul></li><li><strong>ConsoleControl:</strong> <code>YES</code><ul><li>macOS 引导加载程序基于文本输出的控制台控制协议, 某些固件缺少该协议。当协议已经在固件中可用时, 需要设置此选项, 并且使用其他控制台控制选项, 例如 <code>IgnoreTextInGraphics</code>, <code>SanitiseClearScreen</code> 以及 <code>ConsoleBehaviourUi</code> 的 <code>ConsoleBehaviourOs</code></li></ul></li><li><strong>DataHub:</strong> <code>NO</code><ul><li>重新安装数据库</li></ul></li><li><strong>DeviceProperties:</strong> <code>NO</code><ul><li>确保在 VM 或旧白苹果上完全兼容</li></ul></li><li><strong>FirmwareVolume:</strong> <code>NO</code><ul><li>修复 Filevault 的 UI 问题, 设置为 <code>YES</code> 可以获得更好地兼容 FileVault</li></ul></li><li><strong>HashServices:</strong> <code>NO</code><ul><li>修复运行 FileVault 时鼠标光标大小不正确的问题, 设置为 <code>YES</code> 可以更好地兼容 FileVault</li></ul></li><li><strong>UnicodeCollation:</strong> <code>NO</code><ul><li>一些较旧的固件破坏了 Unicode 排序规则, 设置为 <code>YES</code> 可以修复这些系统上 UEFI Shell 的兼容性 (通常为用于 IvyBridge 或更旧的设备)</li></ul></li></ul><hr><p><strong>Quirks:</strong></p><ul><li><p><strong>AvoidHighAlloc:</strong> <code>NO</code></p><ul><li>主板无法正确访问 UEFI Boot Services 中更高内存的解决方法。除非有必要, 否则避免使用</li></ul></li><li><p><strong>ClearScreenOnModeSwitch:</strong> <code>NO</code></p><ul><li>从图形模式切换到文本模式时, 某些固件仅清除屏幕的一部分, 导致屏幕上残留之前绘制的图片。 此选项会在切换到文本模式之前用黑色填充整个屏幕</li></ul></li><li><p><strong>ExitBootServicesDelay:</strong> <code>0</code></p></li><li><p><strong>IgnoreInvalidFlexRatio:</strong> <code>NO</code></p><ul><li>BIOS 中无法禁用 <code>MSR_FLEX_RATIO(0x194)</code> 时开启</li></ul></li><li><p><strong>IgnoreTextInGraphics:</strong> <code>NO</code></p><ul><li>修复不用 <code>-v</code> 开机时日志覆盖苹果标志输出的问题</li></ul></li><li><p><strong>ProvideConsoleGop:</strong> <code>YES</code></p><ul><li>macOS 引导加载程序要求 GOP (图形输出协议) 存在于控制台句柄上</li><li>如果选择启动项之后不出现 macOS 启动 Verbose 请启用</li></ul></li><li><p><strong>ReconnectOnResChange:</strong> <code>NO</code></p><ul><li>有些固件在 GOP 分辨率改变后要求重新连接控制器才能输出文本, 开启这个选项会导致从 UEFI Shell 中启动 OpenCore 时直接黑屏, 尽量避免开启</li></ul></li><li><p><strong>ReleaseUsbOwnership:</strong> <code>NO</code></p><ul><li>从固件驱动程序中释放 USB 控制器所属权, 除非您不知道自己在做什么, 否则避免使用。Clover 的等效设置是 <code>FixOwnership</code></li></ul></li><li><p><strong>ReplaceTabWithSpace:</strong> <code>NO</code></p><ul><li>取决于固件, 某些设备在 UEFI Shell 中编辑文件使用 <code>Tab键</code> 出问题时启用。注意, 此选项需要将 <code>ConsoleControl</code> 设置为 <code>YES</code></li></ul></li><li><p><strong>RequestBootVarRouting:</strong> <code>YES</code></p><ul><li>从 <code>EFI_GLOBAL_VARIABLE_GUID</code> 中为 <code>OC_VENDOR_VARIABLE_GUID</code> 请求 redirectBoot 前缀变量</li></ul><blockquote><p>启用此项以便能够在与 macOS 引导项设计上不兼容的固件中可靠地使用 <code>启动磁盘</code> 设置</p></blockquote></li><li><p><strong>SanitiseClearScreen:</strong> <code>YES</code></p><ul><li>修复 OpenCore 在高分屏中以 1024x768 显示的问题, 注意要同时开启 <code>ConsoleControl</code> 并将 <code>ConsoleMode</code> 的内容留空</li></ul></li><li><p><strong>UnblockFsConnect:</strong> <code>NO</code></p><ul><li>惠普笔记本在 OpenCore 引导界面没有引导项时设置为 <code>YES</code></li></ul></li></ul><p><strong>你的 EFI 现在应该是什么样子:</strong></p><p><img src="/images/loading.gif" data-original="http://7.daliansky.net/OpenCore/StructureFilled.png" alt="ConfigComplete"></p><hr><h3 id="解决-clover-和-opencore-的冲突"><a class="markdownIt-Anchor" href="#解决-clover-和-opencore-的冲突"></a> 解决 Clover 和 OpenCore 的冲突</h3><p><strong>在重启进入 OpenCore 之前, 我们还需要解决一些冲突问题:</strong></p><ul><li><p>删除 Clover 设置面板</p><blockquote><p>Clover 设置面板会和 OpenCore 产生冲突, 需要删除</p></blockquote><ul><li>Clover 设置面板位于 <code>/Library/PreferencePanes/Clover.prefPane</code></li><li>终端输入 <code>sudo rm -rf /Library/PreferencePanes/Clover.prefPane</code> 删除</li></ul></li><li><p>清理 Clover 的模拟 NVRAM RC 脚本 和 守护程序 <code>CloverDaemonNew</code></p><blockquote><p>在终端中输入:</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 删除 ESP 分区下的 nvram.plist</span></span><br><span class="line">rm -rf /Volumes/(你的 ESP 分区)/nvram.plist</span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除 RC 脚本</span></span><br><span class="line">rm -rf <span class="string">"/etc/rc.clover.lib"</span></span><br><span class="line">rm -rf <span class="string">"/etc/rc.boot.d/10.save_and_rotate_boot_log.local"</span></span><br><span class="line">rm -rf <span class="string">"/etc/rc.boot.d/20.mount_ESP.local"</span></span><br><span class="line">rm -rf <span class="string">"/etc/rc.boot.d/70.disable_sleep_proxy_client.local.disabled"</span></span><br><span class="line">rm -rf <span class="string">"/etc/rc.boot.d/80.save_nvram_plist.local"</span></span><br><span class="line">rm -rf <span class="string">"/etc/rc.shutdown.local"</span></span><br><span class="line">rm -rf <span class="string">"/etc/rc.boot.d"</span></span><br><span class="line">rm -rf <span class="string">"/etc/rc.shutdown.d"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除 Clover 新开发的 NVRAM 守护程序 `CloverDaemonNew`</span></span><br><span class="line">launchctl unload <span class="string">'/Library/LaunchDaemons/com.slice.CloverDaemonNew.plist'</span></span><br><span class="line">rm -rf <span class="string">'/Library/LaunchDaemons/com.slice.CloverDaemonNew.plist'</span></span><br><span class="line">rm -rf <span class="string">'/Library/Application Support/Clover/CloverDaemonNew'</span></span><br><span class="line">rm -rf <span class="string">'/Library/Application Support/Clover/CloverLogOut'</span></span><br><span class="line">rm -rf <span class="string">'/Library/Application Support/Clover/CloverWrapper.sh'</span></span><br></pre></td></tr></table></figure></li><li><p>重置「硬件」NVRAM</p><blockquote><p>为了尽可能减少问题出现的概率, 建议在 Clover 和 OpenCore 之间切换时重置「硬件」NVRAM</p></blockquote><ul><li>通过 Clover F11 清除<ol><li><p>删除 Clover 内的 <code>EmuVariableUefi.efi</code> (通常位于 <code>Drives/UEFI/</code> 或 <code>drivers64UEFI/</code> 目录下)</p><blockquote><p>如果不删除 <code>EmuVariableUefi.efi</code>, Clover 只会重置模拟出来的原本就是空的 NVRAM</p></blockquote></li><li><p>重启进入 Clover 引导项选择界面然后按下 <code>F11</code> 或 <code>Fn+F11</code> 直到设备自动重启</p></li></ol></li></ul></li></ul><ol><li>开机直接选择 UEFI 引导项进入 OpenCore</li></ol><ul><li><p>通过 OpenCore 重置</p><blockquote><p>参考下文</p></blockquote></li></ul><h3 id="现在是时候开机见分晓了"><a class="markdownIt-Anchor" href="#现在是时候开机见分晓了"></a> 现在是时候开机见分晓了</h3><p><img src="/images/loading.gif" data-original="http://7.daliansky.net/OpenCore/Success.png" alt="Success"></p><h2 id="完善与优化"><a class="markdownIt-Anchor" href="#完善与优化"></a> 完善与优化</h2><p>这里只简单写了一些网上暂时还找不到中文解决方案的一些问题, 强烈推荐在看这里的同时参阅 <a href="https://blog.xjn819.com/?p=543" target="_blank" rel="noopener">xjn 大佬的博客</a></p><h3 id="排除常见错误"><a class="markdownIt-Anchor" href="#排除常见错误"></a> 排除常见错误</h3><p><strong>遇到如下问题可以尝试这样设置:</strong></p><ol><li><p>进入 OpenCore 时卡在 <code>no vault provided!</code>:</p><ul><li><strong><code>Misc → Security</code></strong><ul><li><code>RequireSignature</code> = <code>NO</code></li><li><code>RequireVault</code> = <code>NO</code></li></ul></li></ul></li><li><p>选完启动项后卡在 <code>EndRandomSeed</code> 或直接卡死</p><ul><li><p>如果等一会能进入系统但是不跑码「或」不显示第一阶段的苹果标志:</p><ul><li><strong><code>UEFI → Quirks</code></strong><ul><li><code>ProvideConsoleGop</code> = <code>YES</code></li></ul></li></ul></li><li><p>如果完全卡死:</p><ul><li>尝试 <code>Misc → Boot</code> 下 <code>PollAppleHotKeys</code> = <code>NO</code>, <code>UEFI → Input</code> 下 <code>KeySupport</code> = <code>NO</code>, 并换用 <code>UsbKbDxe.efi</code></li><li>这个设备的 CFG 很可能有锁, 如下方案 <strong>「二选一」</strong><ol><li><p>解锁 CFG (建议), <a href="https://blog.xjn819.com/?p=317" target="_blank" rel="noopener">参考 xjn 教程中的 <code>解锁BIOS中的CFG功能</code> 小节</a></p></li><li><p><code>Kernel → Quirks</code> 下 <code>AppleCpuPmCfgLock</code> = <code>YES</code>, <code>AppleCpuPmCfgLock</code> = <code>YES</code></p><blockquote><p>这个方法的代价是丧失原生电源管理, 「不」建议长期使用</p></blockquote></li></ol></li></ul></li></ul></li><li><p>卡在 <code>PCI Configuration Begin</code></p><ul><li><p>BIOS 关闭 CSM 并设置操作系统模式为 <strong>Win8.1/10</strong></p></li><li><p>依次尝试如下引导标识符</p><ul><li>npci=0x2000</li><li>npci=0x3000</li></ul></li><li><p>如果依旧不行, 将 <strong><code>Booter → MmioWhitelist → Item 1 (Generic...)</code></strong> 下的 <code>Enabled</code> 改为 <code>True</code></p><blockquote><p>4 代 CPU 主板可以尝试同时开启 <code>Item 0</code> 下的补丁</p></blockquote></li></ul></li><li><p>开机出现 <code>Failed to parse real field of type 1</code></p><blockquote><p>这是因为 OC 本身不支持 <code>real</code> 类型的数据, Xcode 在编辑较长的数字的时候会自动将 <code>Integer</code> 转换为 <code>real</code></p></blockquote><ol><li>用 VS Code 打开 config.plist</li><li>Command + F 查找替换所有 <code>real</code> 为 <code>Integer</code></li></ol></li><li><p>开机卡在 <code>This version of Mac OS X is not supported</code></p><ul><li>检查 Config 内 PlatformInfo 是否填写无误<ul><li><code>Automatic</code> = <code>YES</code></li><li>如果使用的是 SampleFull, 确保所有内容都已完整填写</li></ul></li></ul></li><li><p>300 系主板卡在 <code>apfs_module_start</code></p><ul><li>较新的主板使用了新的时钟 <code>AWAC</code> 来代替 <code>RTC</code>, 这个设备与 macOS 不兼容, 下面的方法 <strong>「二选一」</strong><ul><li>(推荐) 添加 <a href="https://github.com/acidanthera/OpenCorePkg/blob/master/Docs/AcpiSamples/SSDT-AWAC.dsl" target="_blank" rel="noopener">SSDT-AWAC</a> 来屏蔽 <code>AWAC</code> 并启动 <code>RTC</code></li><li>用 <a href="https://github.com/acidanthera/OpenCorePkg/blob/master/Docs/AcpiSamples/SSDT-RTC0.dsl" target="_blank" rel="noopener">SSDT-RTC0</a> 仿冒 RTC</li></ul></li></ul></li><li><p>华硕或惠普关机后 BIOS 重置或被强制进入安全模式</p><ul><li>将 <strong><code>Kernel → Patch → Item 0 (com.apple.driver.AppleRTC)</code></strong> 下的 <code>Enabled</code> 改为 <code>YES</code> 来开启 AppleRTC Patch</li></ul></li><li><p>UEFI 引导项选择完 OpenCore 之后直接跳回选择界面</p><ul><li>参考上文重新核对 ESP 分区中的文件夹结构, 确保 UEFI 启动项添加的是 OpenCore 的 <code>Bootx64.efi</code></li></ul></li></ol><h3 id="模拟-nvram"><a class="markdownIt-Anchor" href="#模拟-nvram"></a> 模拟 NVRAM</h3><h4 id="开始之前先在这里澄清一些被广泛误解的理论并解释一些常见问题"><a class="markdownIt-Anchor" href="#开始之前先在这里澄清一些被广泛误解的理论并解释一些常见问题"></a> 开始之前先在这里澄清一些被广泛误解的理论并解释一些常见问题</h4><ul><li><p><strong>什么是 NVRAM:</strong></p><ul><li>非易失性随机存取存储器 (NVRAM) 是随机存取存储器 (RAM) 的一种; 在依赖主板上 CMOS 电池时, 即使断开电脑电源, 该存储器仍可以保证存储的数据不丢失</li><li>NVRAM 里存有大量敏感参数, 如: UEFI 安全启动的 <code>KEK</code>, <code>PK</code>, <code>DB</code> 和 <code>DBX</code>, 因此 NVRAM 需要是一种提供随机访问功能的非易失性存储器, 且需要通过特定的 <a href="https://github.com/erikberglund/AppleNVRAM" target="_blank" rel="noopener">GUID</a> 读写</li></ul></li><li><p><strong>没有「原生 NVRAM 」的含义:</strong></p><ul><li>所谓 “没有「原生」NVRAM” 实际上指的是 macOS 在 <strong>使用 APTIO 内存修复驱动</strong> 的环境下 NVRAM 的「写入」依旧没有被修复, 导致变量无法存入主板</li><li>现在支持 UEFI 的主板都支持 NVRAM, 而且 NVRAM 在 Windows 或者 Linux 下完全正常工作</li><li>macOS 可以正常读取 NVRAM, 也就是说在 Windows 下给 NVRAM 中的 <a href="https://github.com/erikberglund/AppleNVRAM/blob/master/Apple/7C436110-AB2A-4BBB-A880-FE41995C9F82.md" target="_blank" rel="noopener"><code>7C436110-AB2A-4BBB-A880-FE41995C9F82:bootargs</code></a> 加上 <code>-v</code> 后重启进入 macOS 会直接进入啰嗦模式</li><li>「没有 原生 NVRAM」很容易误解为这个主板如同传统 <code>BIOS + MBR</code> 引导的主板一样完全不支持 NVRAM</li><li><strong>「原生 NVRAM」实际上应该理解为 macOS 可以正常读写「硬件」NVRAM</strong></li></ul></li><li><p><strong>没有原生或模拟 NVRAM 的影响:</strong></p><ul><li>无法使用偏好设置的 <code>启动磁盘</code> 为 OpenCore 指定默认引导项</li><li>FakeSMC 的部分 SMC Key 无法保存</li><li>AsusSMC.kext 会丢失键盘在上次关机时的亮度</li></ul><blockquote><p>没有原生或模拟 NVRAM 完全不影响系统的正常运作, 更不存在不模拟 NVRAM 就没法开机的谬论</p></blockquote></li><li><p><strong>哪些主板的硬件 NVRAM 在 macOS 下不正常工作:</strong></p><blockquote><p>这里只讨论 <a href="https://ami.com/en/products/bios-uefi-firmware/" target="_blank" rel="noopener">AMI APTIO</a> 固件的主板, <a href="https://www.insyde.com/products" target="_blank" rel="noopener">Insyde</a> 固件的主板 (常见于联想笔记本) 理论上不存在 NVRAM 问题</p></blockquote><ul><li>300系 采用新 APTIO V NVRAM 保存方式的主板<ul><li>B360</li><li>B365</li><li>H310</li><li>H370</li><li>Q370</li><li>Z390</li><li>HM370 (移动端)</li><li>QM370 (移动端)</li></ul><blockquote><p>Z370 由于是 200 系的马甲, NVRAM 正常工作</p></blockquote></li><li>C系列 服务器芯片组主板<ul><li>C621</li><li>C612</li></ul></li><li>部分 X99 和 X299 芯片组主板</li></ul></li><li><p><strong>验证你的主板的 NVRAM 在 macOS 下是否正常工作:</strong></p><blockquote><p>有时候只参考并不能得出准确的结论, 实际试验一下更加准确</p></blockquote><ol><li>删除引导工具内的 <code>VariableRuntimeDxe.efi</code>, <code>EmuVariableRuntimeDxe.efi</code>, <code>EmuVariableUefi.efi</code></li><li>删除 NVRAM 导出脚本 <code>LogoutHook</code>(参考下文), <code>RC Script</code>(参考上文)</li><li>删除 EFI 分区根目录下的 <code>nvram.plist</code></li><li>重启</li><li>在终端输入 <code>sudo nvram myvar=test</code></li><li>再次重启</li><li>在终端输入 <code>nvram -p | grep -i myvar</code></li><li>如果终端成功输出了 <code>test</code> 那就说明你的主板在 macOS 下硬件 NVRAM 正常工作, 反之就是「不」正常工作</li></ol></li><li><p><strong>模拟 NVRAM 是什么, LogoutHook 扮演什么角色:</strong></p><ul><li><strong>模拟 NVRAM</strong> 是通过 <code>VariableRuntimeDxe</code>(<code>EmuVariableRuntimeDxe</code>/<code>EmuVariableUefi</code>) 模拟出一个 macOS 可读写的重启「不记忆」NVRAM, 里面的内容与硬件层面的 NVRAM 完全隔离, 引导工具在加载完这个驱动后自身也会进入这个环境中并失去对硬件 NVRAM 的控制</li><li><strong>LogoutHook</strong> 是一个在账户注销前运行的脚本, 运行时会用 <code>nvram -x</code> 命令将 NVRAM 中的信息导出至 EFI 分区根目录的 <code>nvram.plist</code> 中, OpenCore 在下一次开机时会读取 <code>nvram.plist</code> 里面的内容并写进硬件 NVRAM 中</li></ul></li><li><p><strong>可以直接使用别人生成的 <code>nvram.plist</code> 吗</strong></p><ul><li>使用别人的 <code>nvram.plist</code> 时, 只有 <a href="https://github.com/erikberglund/AppleNVRAM/blob/master/Apple/7C436110-AB2A-4BBB-A880-FE41995C9F82.md" target="_blank" rel="noopener"><code>7C436110-AB2A-4BBB-A880-FE41995C9F82</code></a> 下的内容可以正常工作</li><li><a href="https://github.com/erikberglund/AppleNVRAM/blob/master/EFI/8BE4DF61-93CA-11D2-AA0D-00E098032B8C.md" target="_blank" rel="noopener"><code>8BE4DF61-93CA-11D2-AA0D-00E098032B8C</code></a> 下的内容由于 UUID 不同完全无法工作, 完全无法为 OpenCore 指定默认引导项</li><li>即使不模拟 NVRAM, OpenCore 和 FwRuntimeServices 提供的 <a href="https://github.com/erikberglund/AppleNVRAM/blob/master/Apple/7C436110-AB2A-4BBB-A880-FE41995C9F82.md" target="_blank" rel="noopener"><code>7C436110-AB2A-4BBB-A880-FE41995C9F82</code></a> 模拟已经足以在 <code>nvram.plist</code> 中正确生成此项</li><li><strong>所以这么做完全没有意义</strong></li></ul></li></ul><h4 id="用-logouthook-模拟-nvram-并为-opencore-指定默认引导项"><a class="markdownIt-Anchor" href="#用-logouthook-模拟-nvram-并为-opencore-指定默认引导项"></a> 用 LogoutHook 模拟 NVRAM 并为 OpenCore 指定默认引导项</h4><p>确认主板在 macOS 下 NVRAM 不正常工作后我们可以通过安装 OpenCore 提供的 LogoutHook 来模拟 NVRAM</p><blockquote><p>这里强烈建议在开始之前用 OpenCore 重置 NVRAM 并通过 <code>VariableRuntimeDxe.efi</code> 创建一个虚拟的可正常读写的 NVRAM</p><p>如果严格按照这个流程执行且 Config 内 <code>BlessOverride</code> 和启动项的路径均已设置正确, 那么理论上 <code>启动磁盘</code> 为 OpenCore 指定默认引导项的功能已经可以正常工作</p><p>如果 OpenCore 无法正确识别 Windows 建议先修复这个问题再模拟 NVRAM</p></blockquote><ol><li><p>按照上文的方法清理 Clover 的 RC 脚本</p></li><li><p>彻底删除之前安装的 LogoutHook</p><ul><li><p>终端输入: <code>sudo defaults read com.apple.loginwindow LogoutHook</code> 来获取 LogoutHook 的路径</p><blockquote><p>如果终端输出的不是一串路径, 而是</p><p><code>The domain/default pair of (com.apple.loginwindow, LogoutHook) does not exist</code></p><p>说明系统内没有安装 LogoutHook, <strong>跳过下面的命令</strong>直接继续下一步 Config 的设置</p></blockquote></li><li><p>输入如下命令来删除 <code>LogoutHook.command</code> 并清空触发设置 <strong>(请按顺序执行!!!)</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 删除文件 LogoutHook.command</span></span><br><span class="line">sudo rm -rf $(sudo defaults <span class="built_in">read</span> com.apple.loginwindow LogoutHook)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 清空 LogoutHook 的触发设置</span></span><br><span class="line">sudo defaults delete com.apple.loginwindow LogoutHook</span><br></pre></td></tr></table></figure></li></ul></li><li><p>Config 中:</p><ul><li><strong><code>Booter → Quirks → DisableVariableWrite</code></strong> 设置为 <code>YES</code></li><li><strong><code>Misc → Security → AllowNvramReset</code></strong> 设置为 <code>YES</code></li><li><strong><code>Misc → Security → ExposeSensitiveData</code></strong> 设置为 <code>3</code></li><li><strong><code>NVRAM → LegacyEnable</code></strong> 设置为 <code>NO</code></li></ul></li><li><p>删除引导工具内 <strong>config.plist「和」Drivers 目录</strong> 下的 <code>VariableRuntimeDxe.efi</code>, <code>EmuVariableRuntimeDxe.efi</code></p></li><li><p>删除 EFI 分区下的 <code>nvram.plist</code></p></li><li><p>重启</p></li><li><p>进入 OpenCore 然后 选择引导界面的重置 NVRAM 选项「或者」按下快捷键 <code>Command + Option + P + R</code></p></li><li><p>设备自动重启后, 进入 BIOS, Windows 或者 Win PE 重新为 OpenCore 添加引导项</p><blockquote><p>OpenCore 重置 NVRAM 时相比 Clover 会重置更多的变量, 理论上更干净, 但是会导致 UEFI 引导项丢失</p></blockquote></li><li><p>进入 macOS, 在 Config 里将 <strong><code>NVRAM → LegacyEnable</code></strong> 设置为 <code>YES</code>, <strong><code>UEFI → Drivers</code></strong> 下添加 <code>VariableRuntimeDxe.efi</code></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">▼ UEFI                  <span class="tag">&lt;<span class="name">Dictionary</span>&gt;</span></span><br><span class="line">|__ ▼ Drivers           <span class="tag">&lt;<span class="name">Array</span>&gt;</span></span><br><span class="line">    |__ Item #          <span class="tag">&lt;<span class="name">String</span>&gt;</span>          FwRuntimeServices.efi</span><br><span class="line">    |__ Item #+1        <span class="tag">&lt;<span class="name">String</span>&gt;</span>          VariableRuntimeDxe.efi</span><br></pre></td></tr></table></figure></li><li><p>在 <strong><code>EFI/OC/Drivers</code></strong> 文件夹下放入 <a href="https://github.com/williambj1/OpenCore-Factory/releases/tag/OpenCore-UEFI-Drivers" target="_blank" rel="noopener"><code>VariableRuntimeDxe.efi</code></a></p></li><li><p>再次重启</p></li><li><p>进入 macOS, 打开 <code>偏好设置/启动磁盘</code>, 解锁后选择你的 macOS 分区然后 <strong>「锁上」</strong></p></li><li><p>终端输入命令检查 NVRAM 变量是否成功写入:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/sbin/nvram -x <span class="string">'8BE4DF61-93CA-11D2-AA0D-00E098032B8C:Boot0080'</span> | /usr/bin/sed <span class="string">'/\&lt;data\&gt;/,/\&lt;\/data\&gt;/!d;//d'</span> | /usr/bin/base64 --decode</span><br></pre></td></tr></table></figure><ul><li>如果输出的「结尾」部分包含 <code>\System\Library\CoreServices\boot.efi</code> 我们可以继续执行下面的步骤</li><li>如果显示 <code>nvram: Error getting variable - '8BE4DF61-93CA-11D2-AA0D-00E098032B8C:Boot0080': (iokit/common) data was not found</code> 说明模拟 NVRAM 没有成功, 请回到第一步重来</li></ul></li><li><p>在终端中输入 <code>sudo</code> + <code>空格</code> 然后将 LogoutHook 拉进终端的「窗口中」, 按下回车, 输入密码, 再次回车 (临时运行 LogoutHook)</p></li><li><p>终端中会出现一排上上步提到的错误, 这是正常的因为我们没有其它的引导项 (<code>Boot0081~3</code>) 和上次引导的记录 (<code>BootCurrent</code>) 等等, 只需要确保 <strong>「没有任何关于」<code>Boot0080</code> 和 <code>BootOrder</code></strong> 的错误出现就可以了 (<code>BootNext</code> 也会报错但是实测没有影响)</p></li><li><p>挂载 EFI 分区并打开根目录下的 <code>nvram.plist</code>, 检查 <strong><code>Boot0080</code> 和 <code>BootOrder</code></strong> 是否存在</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">▼ ROOT                                          <span class="tag">&lt;<span class="name">Dictionary</span>&gt;</span></span><br><span class="line">|__ ▼ Add                                       <span class="tag">&lt;<span class="name">Dictionary</span>&gt;</span></span><br><span class="line">    |__ ▼ 7C436110-AB2A-4BBB-A880-FE41995C9F82  <span class="tag">&lt;<span class="name">Dictionary</span>&gt;</span></span><br><span class="line">    |   |__ ...                                 <span class="tag">&lt;<span class="name">Data</span>&gt;</span>        ...</span><br><span class="line">    |   |__ 用 Hackintool 核对内容是否一致</span><br><span class="line">    |__ ▼ 8BE4DF61-93CA-11D2-AA0D-00E098032B8C  <span class="tag">&lt;<span class="name">Dictionary</span>&gt;</span></span><br><span class="line">        |__ Boot0080                            <span class="tag">&lt;<span class="name">Data</span>&gt;</span>        ...</span><br><span class="line">        |__ BootOrder                           <span class="tag">&lt;<span class="name">Data</span>&gt;</span>        ...</span><br></pre></td></tr></table></figure></li><li><p>如果没有问题, 在终端输入如下命令「安装」LogoutHook:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mv (空格, 把 LogoutHook 拖窗口, 然后再空格) <span class="variable">$HOME</span>/.LogoutHook.command</span><br><span class="line"></span><br><span class="line">sudo defaults write com.apple.loginwindow LogoutHook <span class="variable">$HOME</span>/.LogoutHook.command</span><br></pre></td></tr></table></figure><blockquote><p>如果使用 10.12 或更老的系统则需要将 <code>nvram.mojave</code> 也复制到 <code>$HOME</code> 下</p><p><code>mv (空格, 把 nvram.mojave 拖窗口, 然后再空格) $HOME</code></p></blockquote></li><li><p>再次删除引导工具内 <strong>config.plist「和」Drivers 目录</strong> 下的 <code>VariableRuntimeDxe.efi</code></p></li></ol><blockquote><p>非常重要! 不要漏了而前功尽弃!</p></blockquote><ol><li>大功告成!<p align="center"><img src="/images/loading.gif" data-original="http://7.daliansky.net/OpenCore/DefaultBootSuccess.png" alt="DefaultBootSuccess" height="100" width="100"></p></li></ol><blockquote><p><strong>为什么要这样才能开启默认引导项:</strong></p><p>这是一个非常有意思的命题, 已知:</p><p>LogoutHook 在所有情况下都能读取 macOS 写进的变量</p><p>在没有模拟 NVRAM 时</p><ul><li>macOS 可以读取硬件 NVRAM, 不能写入硬件 NVRAM, 可以写入模拟的 <a href="https://github.com/erikberglund/AppleNVRAM/blob/master/Apple/7C436110-AB2A-4BBB-A880-FE41995C9F82.md" target="_blank" rel="noopener"><code>7C436110-AB2A-4BBB-A880-FE41995C9F82</code></a> 但是不能写入 <a href="https://github.com/erikberglund/AppleNVRAM/blob/master/EFI/8BE4DF61-93CA-11D2-AA0D-00E098032B8C.md" target="_blank" rel="noopener"><code>8BE4DF61-93CA-11D2-AA0D-00E098032B8C</code></a></li><li>OC 可以读取写入硬件 NVRAM, 可以读取 <code>nvram.plist</code> 并写入硬件 NVRAM</li></ul><p>使用 VariableRuntimeDxe 时</p><ul><li>macOS 可以读取写入模拟 NVRAM, 无法访问硬件 NVRAM</li><li>OC 可以读取写入模拟 NVRAM, 无法从 <code>nvram.plist</code> 中读取并设置默认引导项但是可以将 <code>nvram.plist</code> 的内容写进模拟 NVRAM, 无法访问硬件 NVRAM</li></ul><p>由此可以推出 OC 的引导项顺序有可能只能从硬件 NVRAM 中读取</p><p>所以上述步骤其实都是为了绕开 <a href="https://github.com/erikberglund/AppleNVRAM/blob/master/EFI/8BE4DF61-93CA-11D2-AA0D-00E098032B8C.md" target="_blank" rel="noopener"><code>8BE4DF61-93CA-11D2-AA0D-00E098032B8C</code></a> 的写入问题, 创建一个模拟的 NVRAM 并获取正常的值并写入 <code>nvram.plist</code> 再用 OC 注入硬件 NVRAM</p><p>如果 OC 和 <code>FwRuntimeServices</code> 提供模拟的 <a href="https://github.com/erikberglund/AppleNVRAM/blob/master/EFI/8BE4DF61-93CA-11D2-AA0D-00E098032B8C.md" target="_blank" rel="noopener"><code>8BE4DF61-93CA-11D2-AA0D-00E098032B8C</code></a> 一切都会变得简单很多</p></blockquote><h3 id="修复-oc-引导界面的显示问题"><a class="markdownIt-Anchor" href="#修复-oc-引导界面的显示问题"></a> 修复 OC 引导界面的显示问题</h3><p><strong>在 Config 中:</strong></p><ul><li><strong><code>UEFI → Protocols</code></strong><ul><li><code>ConsoleControl</code> = <code>YES</code></li></ul></li><li><strong><code>UEFI → Quirks</code></strong><ul><li><code>ProvideConsoleGop</code> = <code>YES</code></li><li><code>IgnoreTextInGraphics</code> = <code>YES</code></li><li><code>SanitiseClearScreen</code> = <code>YES</code></li></ul></li><li><strong><code>Misc → Boot</code></strong><ul><li><code>ConsoleMode</code> = <code>留空</code></li><li><code>Resolution</code> 设置为显示器的正常分辨率, 如 4k: <code>3840x2160</code></li><li><strong>4 代及以下</strong><ul><li><code>ConsoleBehaviourOs</code> = <code>Graphics</code></li><li><code>ConsoleBehaviourUi</code> = <code>ForceText</code></li></ul></li><li><strong>5 代 +</strong><ul><li><code>ConsoleBehaviourOs</code> = <code>ForceGraphics</code></li><li><code>ConsoleBehaviourUi</code> = <code>ForceText</code></li></ul></li><li><strong>在有的固件上将两「留空」或者设为 <code>Graphics</code> 和 <code>Text</code> 效果更好</strong></li></ul></li></ul><blockquote><p>如果 OC 界面出现在显示屏中央, 即使画面没有扭曲也说明分辨率不正常</p><p>将 <code>ConsoleMode</code> 设置为 <code>Max</code> 并关闭 <code>SanitiseClearScreen</code> 在某些固件上也可以做到分辨率正确, 但是这个方法官方 <strong>「不」推荐使用</strong></p></blockquote><h3 id="修改-opencore-引导界面的启动项名称"><a class="markdownIt-Anchor" href="#修改-opencore-引导界面的启动项名称"></a> 修改 OpenCore 引导界面的启动项名称</h3><p>在与引导项的 <code>.efi</code> 文件的同一目录下添加纯文本文件 <code>.contentDetails</code> 可以修改对应启动项的名称</p><blockquote><p><strong>注意⚠️!!! 启动项名称只能是 ASCII 字符!!!</strong></p><p><strong>下方的命令修改的是当前 macOS 的启动项名称, 修改其它分区的 macOS 前需要先进入其目录, 这里不再赘述</strong></p><p>删掉 <code>.contentDetails</code> 就可以恢复原来的名称</p></blockquote><p><strong>终端输入:</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">sudo -s</span><br><span class="line"></span><br><span class="line"><span class="comment"># 在 macOS 10.15 挂载系统分区为读写</span></span><br><span class="line">mount -uw / &amp;&amp; killall Finder</span><br><span class="line"></span><br><span class="line"><span class="comment"># macOS</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"启动项名称"</span> &gt;&gt; /System/Library/CoreServices/.contentDetails</span><br><span class="line"></span><br><span class="line"><span class="comment"># Windows 没有使用 BlessOverride</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"启动项名称"</span> &gt;&gt; /Volumes/(你的 ESP 分区)/EFI/Boot/.contentDetails</span><br><span class="line"></span><br><span class="line"><span class="comment"># Windows 使用了 BlessOverride</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"启动项名称"</span> &gt;&gt; /Volumes/(你的 ESP 分区)/EFI/Microsoft/Boot/.contentDetails</span><br><span class="line"></span><br><span class="line"><span class="comment"># 退出 sudo -s</span></span><br><span class="line"><span class="built_in">exit</span></span><br></pre></td></tr></table></figure><h2 id="附录1-opencore-支持的内核驱动-kext-及其用途"><a class="markdownIt-Anchor" href="#附录1-opencore-支持的内核驱动-kext-及其用途"></a> 附录[1] – OpenCore 支持的内核驱动 (Kext) 及其用途</h2><blockquote><p>参考 <a href="https://github.com/acidanthera/OpenCorePkg/blob/master/Docs/Kexts.md" target="_blank" rel="noopener">https://github.com/acidanthera/OpenCorePkg/blob/master/Docs/Kexts.md</a></p><p><strong>GitHub 项目的下载地址位于 Release 下, 驱动具体支持的设备请进入项目地址查看</strong></p></blockquote><h3 id="有线网卡"><a class="markdownIt-Anchor" href="#有线网卡"></a> 有线网卡</h3><table><thead><tr><th style="text-align:center">驱动及项目地址</th><th>备注</th></tr></thead><tbody><tr><td style="text-align:center"><a href="https://www.realtek.com/en/directly-download" target="_blank" rel="noopener">AppleRTL8169Ethernet</a></td><td>Realtek RTL8169 官方驱动</td></tr><tr><td style="text-align:center"><a href="https://github.com/Mieze/AtherosE2200Ethernet" target="_blank" rel="noopener">AtherosE2200Ethernet.kext</a></td><td>高通 Atheros Killer E2200 系列驱动</td></tr><tr><td style="text-align:center"><a href="https://github.com/al3xtjames/AtherosL1cEthernet" target="_blank" rel="noopener">AtherosL1cEthernet.kext</a></td><td>高通 Atheros AR813x/815x 驱动</td></tr><tr><td style="text-align:center"><a href="https://github.com/acidanthera/IntelMausi" target="_blank" rel="noopener">IntelMausi.kext</a></td><td>英特尔有线网卡 Acidanthera 分支</td></tr><tr><td style="text-align:center"><a href="https://github.com/Mieze/IntelMausiEthernet" target="_blank" rel="noopener">IntelMausiEthernet.kext</a></td><td>英特尔有线网卡原作者</td></tr><tr><td style="text-align:center"><a href="https://github.com/RehabMan/OS-X-Null-Ethernet" target="_blank" rel="noopener">NullEthernetInjector.kext</a></td><td>仿冒内建网卡 (没有可用的内建网卡时使用)</td></tr><tr><td style="text-align:center"><a href="https://github.com/SergeySlice/RealtekLANv3" target="_blank" rel="noopener">RealtekR1000SL.kext</a></td><td>Realtek 8111B/C/D/E/EP/F/G/GU/8411B 系列驱动</td></tr><tr><td style="text-align:center"><a href="https://github.com/Mieze/RealtekRTL8100" target="_blank" rel="noopener">RealtekRTL8100.kext</a></td><td>Realtek RTL810X 系列驱动</td></tr><tr><td style="text-align:center"><a href="https://github.com/Mieze/RTL8111_driver_for_OS_X" target="_blank" rel="noopener">RealtekRTL8111.kext</a></td><td>Realtek RTL8111/8168 系列驱动</td></tr></tbody></table><h3 id="wi-fi-和蓝牙"><a class="markdownIt-Anchor" href="#wi-fi-和蓝牙"></a> Wi-Fi 和蓝牙</h3><table><thead><tr><th style="text-align:center">驱动及项目地址</th><th>备注</th></tr></thead><tbody><tr><td style="text-align:center"><a href="https://i.applelife.ru/2018/12/442854_AirPortAtheros40.kext.zip" target="_blank" rel="noopener">AirPortAtheros40.kext</a></td><td>高通 Atheros AR92xx/AR93xx 驱动, 仅用于 10.14+</td></tr><tr><td style="text-align:center"><a href="https://github.com/acidanthera/AirportBrcmFixup" target="_blank" rel="noopener">AirportBrcmFixup.kext</a></td><td>非苹果官方博通网卡修复</td></tr><tr><td style="text-align:center"><a href="https://github.com/chunnann/ATH9KFixup" target="_blank" rel="noopener">ATH9KFixup.kext</a></td><td>高通 Atheros AR9xxx 无线网卡修复</td></tr><tr><td style="text-align:center"><a href="https://github.com/acidanthera/BrcmPatchRAM" target="_blank" rel="noopener">BrcmPatchRAM.kext</a></td><td>博通网卡蓝牙固件上传</td></tr><tr><td style="text-align:center"><a href="https://github.com/acidanthera/BT4LEContinuityFixup" target="_blank" rel="noopener">BT4LEContinuityFixup.kext</a></td><td>IOBluetoothFamily 修补</td></tr><tr><td style="text-align:center"><a href="https://d86o2zu8ugzlg.cloudfront.net/mediatek-craft/drivers/MT7612_7610U_D5.0.1.25_SDK1.0.2.18_UI5.0.0.27_20151209.zip" target="_blank" rel="noopener">MT7610</a></td><td>联发科 MT7610</td></tr><tr><td style="text-align:center"><a href="https://d86o2zu8ugzlg.cloudfront.net/mediatek-craft/drivers/RTUSB_D2870-4.2.9.2_UI-4.0.9.6_2013_11_29.zip" target="_blank" rel="noopener">RT5370</a></td><td>联发科 RT5370</td></tr><tr><td style="text-align:center"><a href="https://drive.google.com/file/d/1ZtdMqlvKBbHULJhl1u9omuLOy6j0vx48/view?usp=sharing" target="_blank" rel="noopener">RTL8192CU</a></td><td>Realtek RTL8192CU 驱动 (链接为谷歌云盘)</td></tr></tbody></table><h3 id="键盘-鼠标和触摸设备"><a class="markdownIt-Anchor" href="#键盘-鼠标和触摸设备"></a> 键盘, 鼠标和触摸设备</h3><table><thead><tr><th style="text-align:center">驱动及项目地址</th><th>备注</th></tr></thead><tbody><tr><td style="text-align:center"><a href="https://osxlatitude.com/forums/topic/1948-elan-focaltech-and-synaptics-smart-touchpad-driver-mac-os-x/" target="_blank" rel="noopener">ApplePS2SmartTouchPad.kext</a></td><td>触摸板和键盘</td></tr><tr><td style="text-align:center"><a href="https://github.com/hieplpvip/AsusSMC" target="_blank" rel="noopener">AsusSMC.kext</a></td><td>华硕 Fn 键, 键盘背光灯和环境光传感器 驱动</td></tr><tr><td style="text-align:center"><a href="https://github.com/al3xtjames/NoTouchID" target="_blank" rel="noopener">NoTouchID.kext</a></td><td>禁用 Touch ID 检测, 修复输密码时卡顿</td></tr><tr><td style="text-align:center"><a href="https://github.com/Goldfish64/SerialMouse" target="_blank" rel="noopener">SerialMouse.kext</a></td><td>使用 Microsoft 串行鼠标协议的串行鼠标驱动</td></tr><tr><td style="text-align:center"><a href="https://github.com/alexandred/VoodooI2C" target="_blank" rel="noopener">VoodooI2C.kext</a></td><td>I2C 触摸板/屏 驱动</td></tr><tr><td style="text-align:center"><a href="https://github.com/acidanthera/VoodooPS2" target="_blank" rel="noopener">VoodooPS2Controller.kext</a></td><td>PS2 键盘/触摸板 驱动</td></tr></tbody></table><h3 id="显卡和声卡"><a class="markdownIt-Anchor" href="#显卡和声卡"></a> 显卡和声卡</h3><table><thead><tr><th style="text-align:center">驱动及项目地址</th><th>备注</th></tr></thead><tbody><tr><td style="text-align:center"><a href="https://github.com/acidanthera/AppleALC" target="_blank" rel="noopener">AppleALC.kext</a></td><td>定制万能声卡驱动</td></tr><tr><td style="text-align:center"><a href="https://www.nvidia.com/object/mac-driver-archive.html" target="_blank" rel="noopener">NVIDIA CUDA drivers</a></td><td>NVIDIA CUDA 驱动</td></tr><tr><td style="text-align:center"><a href="https://gfe.nvidia.com/mac-update" target="_blank" rel="noopener">NVIDIA Web-drivers</a></td><td>NVIDIA 显卡驱动</td></tr><tr><td style="text-align:center"><a href="https://github.com/Andrej-Antipov/SNBGraphicsMojaveInstaller" target="_blank" rel="noopener">SNBGraphicsMojaveInstaller</a></td><td>二代酷睿核显驱动, 仅用于 10.14+</td></tr><tr><td style="text-align:center"><a href="https://sourceforge.net/projects/voodoohda/" target="_blank" rel="noopener">VoodooHDA.kext</a></td><td>万能声卡驱动</td></tr><tr><td style="text-align:center"><a href="https://github.com/acidanthera/WhateverGreen" target="_blank" rel="noopener">WhateverGreen.kext</a></td><td>显卡补丁驱动</td></tr><tr><td style="text-align:center"><a href="https://github.com/osy86/Polaris22Fixup" target="_blank" rel="noopener">Polaris22Fixup.kext</a></td><td>Polaris22/VegaM 显卡修复</td></tr></tbody></table><h3 id="cpu-和-smc"><a class="markdownIt-Anchor" href="#cpu-和-smc"></a> CPU 和 SMC</h3><table><thead><tr><th style="text-align:center">驱动及项目地址</th><th>备注</th></tr></thead><tbody><tr><td style="text-align:center"><a href="https://github.com/acidanthera/CPUFriend" target="_blank" rel="noopener">CPUFriend.kext</a></td><td>CPU 变频管理</td></tr><tr><td style="text-align:center"><a href="https://github.com/CloverHackyColor/FakeSMC3_with_plugins" target="_blank" rel="noopener">FakeSMC.kext and sensors</a></td><td>Clover 官方 FakeSMC</td></tr><tr><td style="text-align:center"><a href="https://github.com/headkaze/HWPEnable" target="_blank" rel="noopener">HWPEnabler.kext</a></td><td>启用 HWP</td></tr><tr><td style="text-align:center"><a href="https://github.com/corpnewt/NullCPUPowerManagement" target="_blank" rel="noopener">NullCPUPowerManagement.kext</a></td><td>AMD 和虚拟机专用版本</td></tr><tr><td style="text-align:center"><a href="https://www.insanelymac.com/forum/topic/329704-opcode-emulator-opemu-plug-in-project/" target="_blank" rel="noopener">OpcodeEmulator.kext</a></td><td>Opcode 模拟驱动</td></tr><tr><td style="text-align:center"><a href="https://github.com/interferenc/TSCAdjustReset" target="_blank" rel="noopener">TSCAdjustReset.kext</a></td><td>TSC 频率同步驱动</td></tr><tr><td style="text-align:center"><a href="https://github.com/acidanthera/VirtualSMC" target="_blank" rel="noopener">VirtualSMC.kext 及传感器</a></td><td>Acidanthera 的 SMC 和传感器驱动</td></tr><tr><td style="text-align:center"><a href="https://github.com/RehabMan/VoodooTSCSync" target="_blank" rel="noopener">VoodooTSCSync.kext</a></td><td>TSC 频率同步驱动</td></tr></tbody></table><h3 id="usb-和-其它接口"><a class="markdownIt-Anchor" href="#usb-和-其它接口"></a> USB 和 其它接口</h3><table><thead><tr><th style="text-align:center">驱动及项目地址</th><th>备注</th></tr></thead><tbody><tr><td style="text-align:center"><a href="https://github.com/the-darkvoid/macOS-IOElectrify" target="_blank" rel="noopener">IOElectrify.kext</a></td><td>在雷电 3 设备上启用常开电源</td></tr><tr><td style="text-align:center"><a href="https://github.com/osy86/USBWakeFixup" target="_blank" rel="noopener">USBWakeFixup.kext</a></td><td>修复 Skylake 平台 USB 唤醒黑屏</td></tr><tr><td style="text-align:center"><a href="https://github.com/dukzcry/osx-goodies/tree/master/raid" target="_blank" rel="noopener">SASMegaRAID.kext</a></td><td>LSI MegaRAID SAS 系列 RAID 控制器驱动</td></tr><tr><td style="text-align:center"><a href="https://www.insanelymac.com/forum/topic/321080-sineteks-driver-for-realtek-rtsx-sdhc-card-readers/?do=findComment&amp;comment=2376387" target="_blank" rel="noopener">Sinetek-rtsx.kext</a></td><td>Realtek <code>RTSX</code> SDHC 读卡器驱动</td></tr><tr><td style="text-align:center"><a href="https://github.com/lvs1974/VoodooSDHCMod" target="_blank" rel="noopener">VoodooSDHC.kext</a></td><td>SDHC 读卡器驱动</td></tr></tbody></table><h3 id="其它驱动"><a class="markdownIt-Anchor" href="#其它驱动"></a> 其它驱动</h3><table><thead><tr><th style="text-align:center">驱动及项目地址</th><th>备注</th></tr></thead><tbody><tr><td style="text-align:center"><a href="https://github.com/headkaze/AppleIntelInfo" target="_blank" rel="noopener">AppleIntelInfo.kext</a></td><td>CPU / 核显 变频测试</td></tr><tr><td style="text-align:center"><a href="https://github.com/acidanthera/HibernationFixup" target="_blank" rel="noopener">HibernationFixup.kext</a></td><td>修复因 RTC 变量和 NVRAM 造成的睡眠问题</td></tr><tr><td style="text-align:center"><a href="https://github.com/acidanthera/Lilu" target="_blank" rel="noopener">Lilu.kext</a></td><td>SDK &amp; Library</td></tr><tr><td style="text-align:center"><a href="https://github.com/PMheart/LiluFriend" target="_blank" rel="noopener">LiluFriend.kext</a></td><td>用于确保 Lilu 在 L/E 下正常加载</td></tr><tr><td style="text-align:center"><a href="https://github.com/lvs1974/RTCMemoryFixup" target="_blank" rel="noopener">RTCMemoryFixup.kext</a></td><td>修复 BIOS CMOS (RTC) 内存和 AppleRTC 之间的冲突问题</td></tr><tr><td style="text-align:center"><a href="https://github.com/0xFireWolf/NightShiftUnlocker" target="_blank" rel="noopener">NightShiftUnlocker.kext</a></td><td>解锁 NightShift</td></tr><tr><td style="text-align:center"><a href="https://www.applelife.ru/threads/asus-x550vc-i-asus-x550cc.41752/page-130#post-593586" target="_blank" rel="noopener">WebCamera.kext</a></td><td>某些旧设备的摄像头驱动</td></tr></tbody></table><h2 id="附录2-uefi-驱动-efi-及其用途"><a class="markdownIt-Anchor" href="#附录2-uefi-驱动-efi-及其用途"></a> 附录[2] – UEFI 驱动 (.efi) 及其用途</h2><h3 id="opencore-支持的-uefi-驱动"><a class="markdownIt-Anchor" href="#opencore-支持的-uefi-驱动"></a> OpenCore 支持的 UEFI 驱动</h3><ul><li><a href="https://github.com/acidanthera/AppleSupportPkg" target="_blank" rel="noopener">ApfsDriverLoader</a><ul><li>APFS 文件系统引导驱动</li></ul></li><li><s><a href="https://github.com/acidanthera/AppleSupportPkg" target="_blank" rel="noopener">AppleGenericInput</a></s> 已合并<ul><li>添加了对 <code>AppleKeyMapAggregator</code> 协议支持的用户输入驱动。此外, 还解决了某些固件上的鼠标输入问题, 这是 UsbKbDxe 的等效驱动, 根据固件的不同, 实际效果会更好或更坏</li></ul></li><li><a href="https://github.com/LongSoft/CrScreenshotDxe" target="_blank" rel="noopener">CrScreenshotDxe</a><ul><li>增加 OpenCore UI 内截屏功能, 快捷键为 <code>LCtrl + LAlt + F12</code> ( 左Ctrl + 左Alt + F12)</li></ul></li><li><a href="https://github.com/acidanthera/AppleSupportPkg" target="_blank" rel="noopener">FwRuntimeServices</a><ul><li>通过支持只读和只写 NVRAM 变量来提高 OpenCore 和 Lilu 的安全性。有些设置项, 例如 <code>RequestBootVarRouting</code>, 需要此驱动程序才能正常运行</li></ul></li><li><a href=".">HFSPlus</a><ul><li>苹果自带的闭源 HFS 驱动, 不具有 <code>Bless</code> 和其它功能, 但是启动速度比它的等效驱动 <code>VBoxHfs</code> 快 3 倍</li></ul></li><li><a href="https://github.com/acidanthera/audk" target="_blank" rel="noopener">NvmExpressDxe</a><ul><li>从 Broadwell 开始的大多数固件中都包含此驱动程序。对于 Haswell 及更早的固件, 如果安装了 NVMe SSD 就需要使用</li></ul></li><li><a href="https://github.com/williambj1/OpenCore-Factory/releases/tag/OpenCore-UEFI-Drivers" target="_blank" rel="noopener">MemoryAllocation.efi</a><ul><li>为 Z390/X99 等主板预留第一组 512MB 内存, 帮助引导工具注入内核以及内核缓存至第一组 512MB 内存, 需要配合 FwRuntimeServices 和引导标识符 <code>slide=1</code></li></ul></li><li><a href="https://github.com/acidanthera/audk" target="_blank" rel="noopener">UsbKbDxe</a><ul><li>添加了对 <code>AppleKeyMapAggregator</code> 协议支持的 USB 键盘驱动, 这是 <code>AppleGenericInput</code> 的等效驱动, 根据固件的不同, 实际效果会更好或更坏</li></ul></li><li><a href="https://github.com/williambj1/OpenCore-Factory/releases/tag/OpenCore-UEFI-Drivers" target="_blank" rel="noopener">VariableRuntimeDxe</a><ul><li>EDK II 的 NVRAM 驱动, OpenCore 中用于模拟 NVRAM, 需要配合 <code>FwRuntimeServices</code>(.efi) 和 <code>DisableVariableWrite</code>(Quirk)</li></ul></li><li><a href="https://github.com/acidanthera/VirtualSMC" target="_blank" rel="noopener">VirtualSmc.efi</a><ul><li>UEFI SMC 驱动程序, 对于 FileVault 2 和 macOS 的各个功能是必需的。OpenCore 使用 FakeSMC 时, 需要手动添加 NVRAM 变量, 并且<strong>应继续使用</strong> VirtualSmc<code>.efi</code> 驱动</li></ul></li><li><a href="https://github.com/acidanthera/audk" target="_blank" rel="noopener">VBoxHfs</a><ul><li>具有 <code>bless</code> 支持的 HFS 文件系统驱动程序。该驱动程序可以等效替代 Apple 固件中常见的闭源 HFSPlus 驱动。<strong>此驱动虽然功能更加完善, 但启动速度相比大约慢 3 倍，并且尚未经过安全审核</strong></li></ul></li><li><a href="https://github.com/acidanthera/audk" target="_blank" rel="noopener">XhciDxe</a><ul><li>来自 MdeModulePkg 的 XHCI USB 控制器支持驱动程序。从 Sandy Bridge 开始的大多数固件中都包含此驱动程序。在较旧的固件上可以用于支持 USB 3.0 PCI 卡</li></ul></li></ul><blockquote><p><strong>部分网上无法找到的 UEFI 驱动可以在这里下载</strong></p><p><a href="https://github.com/williambj1/OpenCore-Factory/releases/tag/OpenCore-UEFI-Drivers" target="_blank" rel="noopener"><img src="/images/loading.gif" data-original="https://img.shields.io/badge/OpenCore%20UEFI%20Drivers-%E7%82%B9%E5%87%BB%E4%B8%8B%E8%BD%BD-blue" alt="Download"></a></p></blockquote><h3 id="opencore-不兼容的-uefi-驱动"><a class="markdownIt-Anchor" href="#opencore-不兼容的-uefi-驱动"></a> OpenCore 不兼容的 UEFI 驱动</h3><ul><li><a href="https://sourceforge.net/projects/cloverefiboot/" target="_blank" rel="noopener">AppleImageCodec</a><ul><li>为 Clover 启动 FileVault 2 解码 PNG 和 BMP, <strong>OpenCore 已集成</strong></li></ul></li><li><a href="https://sourceforge.net/projects/cloverefiboot/" target="_blank" rel="noopener">AppleKeyAggregator</a><ul><li>为 Clover 支持 FileVault 2 启动 UI 的驱动, <strong>OpenCore 已集成</strong></li></ul></li><li><a href="https://sourceforge.net/projects/cloverefiboot/" target="_blank" rel="noopener">AppleKeyFeeder</a><ul><li>为 Clover 支持 FileVault 2 内 PS/2 键盘输入的驱动, <strong>OpenCore 已集成</strong></li></ul></li><li><a href="https://sourceforge.net/projects/cloverefiboot/" target="_blank" rel="noopener">AppleUITheme</a><ul><li>为 Clover 支持 FileVault 2 启动 UI 主题的驱动, <strong>OpenCore 已集成</strong></li></ul></li><li><a href="https://github.com/acidanthera/AptioFixPkg" target="_blank" rel="noopener">AptioInputFix</a> &amp; <a href="https://github.com/acidanthera/AppleSupportPkg/tree/3036f16a6e51fa1f7c5981df8d8a4305ac38b272/Platform/AppleGenericInput" target="_blank" rel="noopener">AppleGenericInput</a><ul><li>用于解决 UEFI 固件输入问题的驱动, <strong>已与 OpenCore 合并</strong></li></ul></li><li><a href="https://github.com/acidanthera/AptioFixPkg" target="_blank" rel="noopener">AptioMemoryFix</a><ul><li>NVRAM 和内存驱动, 用于修复 UEFI 固件上的内存问题, <strong>已与 OpenCore 合并为 <code>FwRuntimeServices</code></strong></li></ul></li><li><a href="https://sourceforge.net/projects/cloverefiboot/" target="_blank" rel="noopener">AudioDxe</a><ul><li>用于在 Clover 启动时播放声音的 HDA 驱动, <strong>OpenCore 兼容性未知</strong></li></ul></li><li><a href="https://sourceforge.net/projects/cloverefiboot/" target="_blank" rel="noopener">CsmVideoDxe</a><ul><li>用于 Clover GUI 的显卡驱动, 允许使用更多分辨率, 基于 UEFI BIOS 中的 CSM 兼容模块, 并将启用所需的 CSM, <strong>OpenCore 不兼容</strong></li></ul></li><li><a href="https://sourceforge.net/projects/cloverefiboot/" target="_blank" rel="noopener">DataHubDxe</a><ul><li>macOS 必需的 DataHub 协议, <strong>OpenCore 自带且提供了这个 Quirk</strong></li></ul></li><li><a href="https://sourceforge.net/projects/cloverefiboot/" target="_blank" rel="noopener">EmuVariableUefi</a><ul><li>Clover 的模拟 NVRAM 驱动, <strong>OpenCore 不兼容, 替代品为 <code>VariableRuntimeDxe</code></strong></li></ul></li><li><a href="https://sourceforge.net/projects/cloverefiboot/" target="_blank" rel="noopener">EnglishDxe</a><ul><li>在 UEFI Shell 中支持 UnicodeCollation 协议, <strong>OpenCore 自带且提供了这个 Quirk</strong></li></ul></li><li><a href="https://github.com/acidanthera/audk" target="_blank" rel="noopener">EnhancedFatDxe</a><ul><li>这个驱动已存在于所有 UEFI 固件中, <strong>无法从 OpenCore 直接使用</strong>。由于很多固件的 FAT 支持都有问题, 导致在尝试写入时会损坏文件系统。如果在引导过程中写入 EFI 分区出现问题, 则需要将此驱动用 <a href="https://github.com/LongSoft/UEFITool" target="_blank" rel="noopener">UEFITool</a> 刷入固件中</li></ul></li><li><a href="https://sourceforge.net/projects/cloverefiboot/" target="_blank" rel="noopener">FirmwareVolume</a><ul><li>为 Clover 启动 FileVault 2 创建 FirmwareVolume 光标的驱动, <strong>OpenCore 已集成</strong></li></ul></li><li><a href="https://sourceforge.net/projects/cloverefiboot/" target="_blank" rel="noopener">FSInject</a><ul><li>Clover 用于注入内核驱动 (Kext) 的驱动, <strong>OpenCore 自带且使用更先进的方法</strong></li></ul></li><li><a href="https://sourceforge.net/projects/cloverefiboot/" target="_blank" rel="noopener">HashServiceFix</a><ul><li>修复 UEFI BIOS 中的哈希支持, <strong>OpenCore 自带且提供了这个 Quirk</strong></li></ul></li><li><a href="https://sourceforge.net/projects/cloverefiboot/" target="_blank" rel="noopener">OsxAptioFixDrv</a><ul><li>旧的 Clover NVRAM 和内存驱动, 用于修复 UEFI 固件上的内存问题, <strong>与 FwRuntimeServices 和 OpenCore 不兼容</strong></li></ul></li><li><a href="https://www.reddit.com/r/hackintosh/comments/cfjyla/i_unleashed_a_plague_upon_you_guys_and_i_am_sorry/" target="_blank" rel="noopener">OSXAptioFix2Drv-Free2000.efi</a><ul><li>Clover 的内存驱动, 用于修复 UEFI 固件上的内存问题, <a href="(https://www.reddit.com/r/hackintosh/comments/cfjyla/i_unleashed_a_plague_upon_you_guys_and_i_am_sorry/)">作者已经声明会损坏硬件</a></li></ul></li><li><a href="https://sourceforge.net/projects/cloverefiboot/" target="_blank" rel="noopener">OsxAptioFix3Drv</a><ul><li>Clover NVRAM 和内存驱动, 用于修复 UEFI 固件上的内存问题, <strong>与 FwRuntimeServices 和 OpenCore 不兼容</strong></li></ul></li><li><a href="https://sourceforge.net/projects/cloverefiboot/" target="_blank" rel="noopener">OsxFatBinaryDrv</a><ul><li>Clover 用于支持 OS X 10.9 和更早版本的 FAT Binary 可执行文件的驱动, <strong>与 FwRuntimeServices 和 OpenCore 不兼容</strong></li></ul></li><li><a href="https://sourceforge.net/projects/cloverefiboot/" target="_blank" rel="noopener">OsxLowMemFixDrv</a><ul><li>精简版的 OsxAptioFixDrv, 用于修复 UEFI 固件上的内存问题, <strong>与 FwRuntimeServices 和 OpenCore 不兼容</strong></li></ul></li><li><a href="https://sourceforge.net/projects/cloverefiboot/" target="_blank" rel="noopener">PartitionDxe</a><ul><li>用于支持非常规分区图的驱动, 如: 混合 GPT/MBR 或 Apple 分区图, <strong>OpenCore 兼容性未知</strong></li></ul></li><li><a href="https://sourceforge.net/projects/cloverefiboot/" target="_blank" rel="noopener">Ps2MouseDxe</a><ul><li>PS/2 鼠标驱动, <strong>这个驱动已存在于所有 UEFI 固件中</strong></li></ul></li><li><a href="https://github.com/CloverHackyColor/FakeSMC3_with_plugins" target="_blank" rel="noopener">SMCHelper</a><ul><li>SMCHelper 是 VirtualSmc.efi 在 Clover 中的替代品, 用于与 FakeSMC 配合。<strong>与 VirtualSmc 和 OpenCore 不兼容</strong></li></ul></li><li><strong>其它未在本文中提到的 UEFI 驱动一律不兼容</strong></li></ul><h2 id="附录3-常用内核引导标识符合集"><a class="markdownIt-Anchor" href="#附录3-常用内核引导标识符合集"></a> 附录[3] – 常用内核引导标识符合集</h2><table><thead><tr><th style="text-align:center">引导标识符</th><th>作用</th></tr></thead><tbody><tr><td style="text-align:center"><code>-amd_no_dgpu_accel</code></td><td>关闭 AMD 显卡硬件加速</td></tr><tr><td style="text-align:center"><code>cpus=#</code></td><td>启用 <code>#</code> 个 CPU 核心</td></tr><tr><td style="text-align:center"><a href="http://www.yekki.me/power-nap-and-darkwake-argument/" target="_blank" rel="noopener"><code>darkwake=0</code></a></td><td>禁用 Power Nap</td></tr><tr><td style="text-align:center"><code>dart=0</code></td><td>禁用 VT-d</td></tr><tr><td style="text-align:center"><code>debug=0x100</code></td><td>发生 KP 时不自动重启</td></tr><tr><td style="text-align:center"><code>keepsyms=1</code></td><td>发生 KP 时保留 Debug Symbols, 用于给开发者反馈问题</td></tr><tr><td style="text-align:center"><code>kext-dev-mode=1</code></td><td>启用 Kext 开发模式, 非开发者请勿使用</td></tr><tr><td style="text-align:center"><code>-no_compat_check</code></td><td>关闭兼容性检查</td></tr><tr><td style="text-align:center"><code>npci=0x2000</code></td><td>在旧设备上禁用 kIOPCIConfiguratorPFM64</td></tr><tr><td style="text-align:center"><code>nvda_drv=1</code></td><td>启用 N 卡驱动的老方法, 在 10.12 及以后失效</td></tr><tr><td style="text-align:center"><code>nv_disable=1</code></td><td>关闭 N 卡硬件加速</td></tr><tr><td style="text-align:center"><code>-s</code></td><td>单用户模式</td></tr><tr><td style="text-align:center"><code>slide=#</code></td><td>手动设置 KASLR slide 值为 <code>#</code></td></tr><tr><td style="text-align:center"><code>-v</code></td><td>verbose 跑码模式</td></tr><tr><td style="text-align:center"><code>-x</code></td><td>安全模式</td></tr></tbody></table><blockquote><p>内核驱动提供的引导标识符请去对应驱动的 Readme 查看</p></blockquote><h2 id="参考及引用"><a class="markdownIt-Anchor" href="#参考及引用"></a> 参考及引用</h2><ul><li><a href="https://www.apple.com" target="_blank" rel="noopener">Apple</a> 的 macOS</li><li><a href="https://github.com/acidanthera" target="_blank" rel="noopener">Acidanthera</a> 的 OpenCore 及其<a href="https://github.com/acidanthera/OpenCorePkg/tree/master/Docs" target="_blank" rel="noopener">官方文档</a></li><li><a href="https://github.com/khronokernel" target="_blank" rel="noopener">khronokernel</a> 的 <a href="https://github.com/khronokernel/Getting-Started-With-OpenCore" target="_blank" rel="noopener">Getting-Started-With-OpenCore</a> 和 <a href="https://github.com/khronokernel/Opencore-Vanilla-Desktop-Guide" target="_blank" rel="noopener">Opencore-Vanilla-Desktop-Guide</a></li><li><a href="https://tonymacx86.com/" target="_blank" rel="noopener">Tonymacx86</a> 的 <a href="https://www.tonymacx86.com/resources/clover-emulated-nvram-uninstaller.368/" target="_blank" rel="noopener">Emulated-NVRAM-Uninstaller</a></li><li><a href="https://github.com/xjn819" target="_blank" rel="noopener">xjn</a> 的博客 <a href="https://blog.xjn819.com/?p=543" target="_blank" rel="noopener">使用OpenCore引导黑苹果</a></li></ul><h2 id="鸣谢"><a class="markdownIt-Anchor" href="#鸣谢"></a> 鸣谢</h2><ul><li><a href=".">宪武</a> 提供的 OpenCore SSDT Hotpatch 典范 <a href="https://github.com/daliansky/OC-little" target="_blank" rel="noopener">OC-little</a></li><li><a href="https://github.com/xlivans" target="_blank" rel="noopener">xlivans</a>, <a href="https://github.com/zijun-he" target="_blank" rel="noopener">子俊</a> 对 OpenCore 的大量跟进和研究</li><li>OpenCore 交流群成员进行的大量测试</li><li><a href="https://github.com/williambj1" target="_blank" rel="noopener">Bat.bat</a> 对教程对审核更新完善</li></ul></div><div class="updated"><svg xmlns="http://www.w3.org/2000/svg" width="130" height="20"><lineargradient id="b" x2="0" y2="100%"><stop offset="0" stop-color="#bbb" stop-opacity=".1"/><stop offset="1" stop-opacity=".1"/></lineargradient><clippath id="a"><rect width="130" height="20" rx="3" fill="#fff"/></clippath><g clip-path="url(#a)"><path fill="#555" d="M0 0h55v20H0z"/><path fill="#97CA00" d="M55 0h75v20H55z"/><path fill="url(#b)" d="M0 0h130v20H0z"/></g><g fill="#fff" text-anchor="middle" font-family="Menlo,monospace" font-size="110"><text x="285" y="150" fill="#010101" fill-opacity=".3" textlength="450" transform="scale(.1)">更新日期</text><text x="285" y="140" textlength="450" transform="scale(.1)">更新日期</text><text x="915" y="150" fill="#010101" fill-opacity=".3" textlength="650" transform="scale(.1)">2019-11-21</text><text x="915" y="140" textlength="650" transform="scale(.1)">2019-11-21</text></g></svg></div><div><div><div style="text-align:center;color:#ccc;font-size:14px">-------------本文结束<i class="fa fa-apple"></i>感谢您的阅读-------------</div></div></div><div><div style="padding:10px 0;margin:20px auto;width:90%;text-align:center"><button id="rewardButton" disable="enable" onclick='var e=document.getElementById("QR");"none"===e.style.display?e.style.display="block":e.style.display="none"'><span>打赏</span></button><div>如果文章对您有帮助，就请站长喝杯咖啡吧 ´◡`</div><div id="QR" style="display:none"><div id="wechat" style="display:inline-block"><img id="wechat_qr" src="/images/wechatpay.jpg" alt="黑果小兵 微信支付"><p>微信支付</p></div><div id="alipay" style="display:inline-block"><img id="alipay_qr" src="/images/alipay.jpg" alt="黑果小兵 支付宝"><p>支付宝</p></div></div></div></div><div><div><ul class="qq-qun"><div><p></p><h2>QQ群列表：</h2><p></p><p>688324116 <a href="http://shang.qq.com/wpa/qunwpa?idkey=6bf69a6f4b983dce94ab42e439f02195dfd19a1601522c10ad41f4df97e0da82" target="_blank" rel="noopener">一起黑苹果</a> 2000人群 人满为患<br>331686786 <a href="http://shang.qq.com/wpa/qunwpa?idkey=db511a29e856f37cbb871108ffa77a6e79dde47e491b8f2c8d8fe4d3c310de91" target="_blank" rel="noopener">一起吃苹果</a> 2000人群 人满为患<br>257995340 <a href="http://shang.qq.com/wpa/qunwpa?idkey=8a63c51acb2bb80184d788b9f419ffcc33aa1ed2080132c82173a3d881625be8" target="_blank" rel="noopener">一起啃苹果</a> 2000人群 远景报备群<br>891434070 <a href="http://shang.qq.com/wpa/qunwpa?idkey=be06e4c13e796e06a5cd3151d7fcc8f2feee8f9b68b1620ce8771111e2822084" target="_blank" rel="noopener">Catalina黑苹果交流群</a> 2000人群 远景报备群<br>939122730 <a href="http://shang.qq.com/wpa/qunwpa?idkey=e7fb8ea793aee10f9e86c70cd134867bde4183cc3eb87424e61e50b3e9cabf72" target="_blank" rel="noopener">Catalina黑苹果交流II群</a> 2000人群<br>891677227 <a href="http://shang.qq.com/wpa/qunwpa?idkey=9a1eaa552c45d736bb6b19d82ad80e76bf82729f1c1a975b437aa3858473231d" target="_blank" rel="noopener">黑果小兵高级群</a> 2000人群 尚有空位<br>943307869 <a href="http://shang.qq.com/wpa/qunwpa?idkey=7080e6ff936fd2e207439ea18c0a34b4651db81ff45d0edf27b34a21a037871e" target="_blank" rel="noopener">黑果小兵高级群II</a> 2000人群 新开群，欢迎踊跃加入<br>538643249 <a href="http://shang.qq.com/wpa/qunwpa?idkey=665ed002721454d2e811535020261a04b0aae2fa3b6a2ffde5778a852f892178" target="_blank" rel="noopener">OpenCore技术交流群</a> 500人群 大神众多非OC适配者慎入<br>943181023 <a href="http://shang.qq.com/wpa/qunwpa?idkey=fb772a7e01436d43e1d856a099549551952bb08161ced4a8fc08b4e75e7ab438" target="_blank" rel="noopener">联想小新Air黑苹果交流群</a> 500人群 非专用机型请勿加入<br>701278330 <a href="http://shang.qq.com/wpa/qunwpa?idkey=5bfd8b092f5a3f3079eab8bb1a497973dbba78ad785d9520ad090a931aeb06f6" target="_blank" rel="noopener">黑苹果无线网卡交流群</a> 500人群 DW1820A技术支持群<br></p></div></ul></div></div><div><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者： </strong>黑果小兵</li><li class="post-copyright-link"><strong>本文链接：</strong> <a href="https://blog.daliansky.net/OpenCore-BootLoader.html" title="精解OpenCore">https://blog.daliansky.net/OpenCore-BootLoader.html</a></li><li class="post-copyright-license"><strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fa fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！</li></ul></div><footer class="post-footer"><div class="post-tags"><a href="/tags/教程/" rel="tag"><i class="fa fa-tag"></i> 教程</a> <a href="/tags/opencore/" rel="tag"><i class="fa fa-tag"></i> opencore</a> <a href="/tags/OC-little/" rel="tag"><i class="fa fa-tag"></i> OC-little</a> <a href="/tags/bootloader/" rel="tag"><i class="fa fa-tag"></i> bootloader</a></div><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/macOS-Mojave-10.14.5-18F132-official-version-with-Clover-4928-original-image.html" rel="next" title="【黑果小兵】macOS Mojave 10.14.5 18F132 正式版 with Clover 4928原版镜像"><i class="fa fa-chevron-left"></i> 【黑果小兵】macOS Mojave 10.14.5 18F132 正式版 with Clover 4928原版镜像</a></div><span class="post-nav-divider"></span><div class="post-nav-prev post-nav-item"><a href="/macOS-Mojave-10.14.6-18G87-Release-version-with-Clover-5033-original-image.html" rel="prev" title="【黑果小兵】macOS Mojave 10.14.6 18G87 正式版 with Clover 5050原版镜像[双EFI双平台终极版]">【黑果小兵】macOS Mojave 10.14.6 18G87 正式版 with Clover 5050原版镜像[双EFI双平台终极版] <i class="fa fa-chevron-right"></i></a></div></div></footer></div></article></div></div><div id="gitalk-container"></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span> <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span> <span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div id="sidebar-dimmer"></div><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">文章目录</li><li class="sidebar-nav-overview" data-target="site-overview-wrap">站点概览</li></ul><div class="site-overview-wrap sidebar-panel"><div class="site-overview"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><a href="/"><img class="site-author-image" itemprop="image" src="/images/avatar.png" alt="黑果小兵"></a><p class="site-author-name" itemprop="name">黑果小兵</p><p class="site-description motion-element" itemprop="description">黑果小兵</p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">83</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/index.html"><span class="site-state-item-count">24</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/index.html"><span class="site-state-item-count">201</span> <span class="site-state-item-name">标签</span></a></div></nav><div class="feed-link motion-element"><a href="/atom.xml" rel="alternate"><i class="fa fa-rss"></i> RSS</a></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/daliansky" title="GitHub &rarr; https://github.com/daliansky" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i></a> </span><span class="links-of-author-item"><a href="http://www.jianshu.com/u/df9143008845" title="简书 &rarr; http://www.jianshu.com/u/df9143008845" rel="noopener" target="_blank"><i class="fa fa-fw fa-heartbeat"></i></a> </span><span class="links-of-author-item"><a href="http://shang.qq.com/wpa/qunwpa?idkey=db511a29e856f37cbb871108ffa77a6e79dde47e491b8f2c8d8fe4d3c310de91" title="QQ &rarr; http://shang.qq.com/wpa/qunwpa?idkey=db511a29e856f37cbb871108ffa77a6e79dde47e491b8f2c8d8fe4d3c310de91" rel="noopener" target="_blank"><i class="fa fa-fw fa-qq"></i></a></span></div><div class="links-of-blogroll motion-element links-of-blogroll-block"><div class="links-of-blogroll-title"><i class="fa fa-fw fa-link"></i> Links</div><ul class="links-of-blogroll-list"><li class="links-of-blogroll-item"><a href="https://blog.iamzhl.top" title="https://blog.iamzhl.top" rel="noopener" target="_blank">Athlonreg</a></li><li class="links-of-blogroll-item"><a href="http://www.sqlsec.com" title="http://www.sqlsec.com" rel="noopener" target="_blank">国光</a></li></ul></div></div></div><div class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class="post-toc"><div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#精解-opencore"><span class="nav-number">1.</span> <span class="nav-text">精解 OpenCore</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#什么是-opencore"><span class="nav-number">1.1.</span> <span class="nav-text">什么是 OpenCore</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#为什么选择-opencore"><span class="nav-number">1.2.</span> <span class="nav-text">为什么选择 OpenCore</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#opencore-常见疑问"><span class="nav-number">1.2.1.</span> <span class="nav-text">OpenCore 常见疑问</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#配置-opencore"><span class="nav-number">1.3.</span> <span class="nav-text">配置 OpenCore</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#准备工作"><span class="nav-number">1.3.1.</span> <span class="nav-text">准备工作</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#推荐-bios-设置"><span class="nav-number">1.3.1.1.</span> <span class="nav-text">推荐 BIOS 设置</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#下载如下文件"><span class="nav-number">1.3.1.2.</span> <span class="nav-text">下载如下文件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#需要具备的条件"><span class="nav-number">1.3.1.3.</span> <span class="nav-text">需要具备的条件</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#创建-usb-启动盘"><span class="nav-number">1.3.2.</span> <span class="nav-text">创建 USB 启动盘</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#基础文件夹结构"><span class="nav-number">1.3.3.</span> <span class="nav-text">基础文件夹结构</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#配置思路"><span class="nav-number">1.3.3.1.</span> <span class="nav-text">配置思路</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#配置-configplist"><span class="nav-number">1.3.4.</span> <span class="nav-text">配置 Config.plist</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#acpi"><span class="nav-number">1.3.5.</span> <span class="nav-text">ACPI</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#booter-启动器"><span class="nav-number">1.3.6.</span> <span class="nav-text">Booter 启动器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#deviceproperties-设备属性"><span class="nav-number">1.3.7.</span> <span class="nav-text">DeviceProperties 设备属性</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#kernel-内核"><span class="nav-number">1.3.8.</span> <span class="nav-text">Kernel 内核</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#misc-杂项"><span class="nav-number">1.3.9.</span> <span class="nav-text">Misc 杂项</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#nvram"><span class="nav-number">1.3.10.</span> <span class="nav-text">NVRAM</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#platforminfo-机型信息"><span class="nav-number">1.3.11.</span> <span class="nav-text">PlatformInfo 机型信息</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#macserial"><span class="nav-number">1.3.11.1.</span> <span class="nav-text">macserial</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#uefi"><span class="nav-number">1.3.12.</span> <span class="nav-text">UEFI</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#解决-clover-和-opencore-的冲突"><span class="nav-number">1.3.13.</span> <span class="nav-text">解决 Clover 和 OpenCore 的冲突</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#现在是时候开机见分晓了"><span class="nav-number">1.3.14.</span> <span class="nav-text">现在是时候开机见分晓了</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#完善与优化"><span class="nav-number">1.4.</span> <span class="nav-text">完善与优化</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#排除常见错误"><span class="nav-number">1.4.1.</span> <span class="nav-text">排除常见错误</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#模拟-nvram"><span class="nav-number">1.4.2.</span> <span class="nav-text">模拟 NVRAM</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#开始之前先在这里澄清一些被广泛误解的理论并解释一些常见问题"><span class="nav-number">1.4.2.1.</span> <span class="nav-text">开始之前先在这里澄清一些被广泛误解的理论并解释一些常见问题</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#用-logouthook-模拟-nvram-并为-opencore-指定默认引导项"><span class="nav-number">1.4.2.2.</span> <span class="nav-text">用 LogoutHook 模拟 NVRAM 并为 OpenCore 指定默认引导项</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#修复-oc-引导界面的显示问题"><span class="nav-number">1.4.3.</span> <span class="nav-text">修复 OC 引导界面的显示问题</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#修改-opencore-引导界面的启动项名称"><span class="nav-number">1.4.4.</span> <span class="nav-text">修改 OpenCore 引导界面的启动项名称</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#附录1-opencore-支持的内核驱动-kext-及其用途"><span class="nav-number">1.5.</span> <span class="nav-text">附录[1] – OpenCore 支持的内核驱动 (Kext) 及其用途</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#有线网卡"><span class="nav-number">1.5.1.</span> <span class="nav-text">有线网卡</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#wi-fi-和蓝牙"><span class="nav-number">1.5.2.</span> <span class="nav-text">Wi-Fi 和蓝牙</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#键盘-鼠标和触摸设备"><span class="nav-number">1.5.3.</span> <span class="nav-text">键盘, 鼠标和触摸设备</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#显卡和声卡"><span class="nav-number">1.5.4.</span> <span class="nav-text">显卡和声卡</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#cpu-和-smc"><span class="nav-number">1.5.5.</span> <span class="nav-text">CPU 和 SMC</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#usb-和-其它接口"><span class="nav-number">1.5.6.</span> <span class="nav-text">USB 和 其它接口</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#其它驱动"><span class="nav-number">1.5.7.</span> <span class="nav-text">其它驱动</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#附录2-uefi-驱动-efi-及其用途"><span class="nav-number">1.6.</span> <span class="nav-text">附录[2] – UEFI 驱动 (.efi) 及其用途</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#opencore-支持的-uefi-驱动"><span class="nav-number">1.6.1.</span> <span class="nav-text">OpenCore 支持的 UEFI 驱动</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#opencore-不兼容的-uefi-驱动"><span class="nav-number">1.6.2.</span> <span class="nav-text">OpenCore 不兼容的 UEFI 驱动</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#附录3-常用内核引导标识符合集"><span class="nav-number">1.7.</span> <span class="nav-text">附录[3] – 常用内核引导标识符合集</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#参考及引用"><span class="nav-number">1.8.</span> <span class="nav-text">参考及引用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#鸣谢"><span class="nav-number">1.9.</span> <span class="nav-text">鸣谢</span></a></li></ol></li></ol></div></div></div></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><div class="copyright"><a href="http://www.miitbeian.gov.cn" rel="noopener" target="_blank">辽ICP备15000696号-3 </a>&copy; 2016 – <span itemprop="copyrightYear">2019</span> <span class="with-love" id="animate"><i class="fa fa-apple"></i> </span><span class="author" itemprop="copyrightHolder">黑果小兵</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-area-chart"></i> </span><span title="站点总字数">517k</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-coffee"></i> </span><span title="站点阅读时长">15:40</span></div><div class="busuanzi-count"><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span class="site-uv" title="总访客量"><i class="fa fa-user"></i> <span class="busuanzi-value" id="busuanzi_value_site_uv"></span> </span><span class="site-pv" title="总访问量"><i class="fa fa-eye"></i> <span class="busuanzi-value" id="busuanzi_value_site_pv"></span></span></div></div></footer><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span id="scrollpercent"><span>0</span>%</span></div></div><script>"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script src="/lib/jquery/index.js?v=2.1.3"></script><script src="/lib/velocity/velocity.min.js?v=1.2.1"></script><script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script><script src="//cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js"></script><script src="/lib/reading_progress/reading_progress.js"></script><script src="/js/src/utils.js?v=6.6.0"></script><script src="/js/src/motion.js?v=6.6.0"></script><script src="/js/src/scrollspy.js?v=6.6.0"></script><script src="/js/src/post-details.js?v=6.6.0"></script><script src="/js/src/bootstrap.js?v=6.6.0"></script><script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css"><script src="//cdn.jsdelivr.net/npm/js-md5@0.7.3/src/md5.min.js"></script><script>var gitalk=new Gitalk({clientID:"0da3e792a21a77938da6",clientSecret:"4d2869563000629ee6dbed48fbbf878aea151cb6",repo:"daliansky.github.io",owner:"daliansky",admin:["daliansky"],id:md5(location.pathname),distractionFreeMode:"true"});gitalk.render("gitalk-container")</script><script>function proceedsearch(){$("body").append('<div class="search-popup-overlay local-search-pop-overlay"></div>').css("overflow","hidden"),$(".search-popup-overlay").click(onPopupClose),$(".popup").toggle();var t=$("#local-search-input");t.attr("autocapitalize","none"),t.attr("autocorrect","off"),t.focus()}var isfetched=!1,isXml=!0,search_path="search.xml";0===search_path.length?search_path="search.xml":/json$/i.test(search_path)&&(isXml=!1);var path="/"+search_path,onPopupClose=function(t){$(".popup").hide(),$("#local-search-input").val(""),$(".search-result-list").remove(),$("#no-result").remove(),$(".local-search-pop-overlay").remove(),$("body").css("overflow","")},searchFunc=function(t,e,o){"use strict";$("body").append('<div class="search-popup-overlay local-search-pop-overlay"><div id="search-loading-icon"><i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i></div></div>').css("overflow","hidden"),$("#search-loading-icon").css("margin","20% auto 0 auto").css("text-align","center"),$.ajax({url:t,dataType:isXml?"xml":"json",async:!0,success:function(t){isfetched=!0,$(".popup").detach().appendTo(".header-inner");var n=isXml?$("entry",t).map(function(){return{title:$("title",this).text(),content:$("content",this).text(),url:$("url",this).text()}}).get():t,r=document.getElementById(e),s=document.getElementById(o),a=function(){var t=r.value.trim().toLowerCase(),e=t.split(/[\s\-]+/);e.length>1&&e.push(t);var o=[];if(t.length>0&&n.forEach(function(n){function r(e,o,n,r){for(var s=r[r.length-1],a=s.position,i=s.word,l=[],h=0;a+i.length<=n&&0!=r.length;){i===t&&h++,l.push({position:a,length:i.length});var p=a+i.length;for(r.pop();0!=r.length&&(s=r[r.length-1],a=s.position,i=s.word,p>a);)r.pop()}return c+=h,{hits:l,start:o,end:n,searchTextCount:h}}function s(t,e){var o="",n=e.start;return e.hits.forEach(function(e){o+=t.substring(n,e.position);var r=e.position+e.length;o+='<b class="search-keyword">'+t.substring(e.position,r)+"</b>",n=r}),o+=t.substring(n,e.end)}var a=!1,i=0,c=0,l=n.title.trim(),h=l.toLowerCase(),p=n.content.trim().replace(/<[^>]+>/g,""),u=p.toLowerCase(),f=decodeURIComponent(n.url),d=[],g=[];if(""!=l&&(e.forEach(function(t){function e(t,e,o){var n=t.length;if(0===n)return[];var r=0,s=[],a=[];for(o||(e=e.toLowerCase(),t=t.toLowerCase());(s=e.indexOf(t,r))>-1;)a.push({position:s,word:t}),r=s+n;return a}d=d.concat(e(t,h,!1)),g=g.concat(e(t,u,!1))}),(d.length>0||g.length>0)&&(a=!0,i=d.length+g.length)),a){[d,g].forEach(function(t){t.sort(function(t,e){return e.position!==t.position?e.position-t.position:t.word.length-e.word.length})});var v=[];0!=d.length&&v.push(r(l,0,l.length,d));for(var $=[];0!=g.length;){var C=g[g.length-1],m=C.position,x=C.word,w=m-20,y=m+80;w<0&&(w=0),y<m+x.length&&(y=m+x.length),y>p.length&&(y=p.length),$.push(r(p,w,y,g))}$.sort(function(t,e){return t.searchTextCount!==e.searchTextCount?e.searchTextCount-t.searchTextCount:t.hits.length!==e.hits.length?e.hits.length-t.hits.length:t.start-e.start});var T=parseInt("1");T>=0&&($=$.slice(0,T));var b="";b+=0!=v.length?"<li><a href='"+f+"' class='search-result-title'>"+s(l,v[0])+"</a>":"<li><a href='"+f+"' class='search-result-title'>"+l+"</a>",$.forEach(function(t){b+="<a href='"+f+'\'><p class="search-result">'+s(p,t)+"...</p></a>"}),b+="</li>",o.push({item:b,searchTextCount:c,hitCount:i,id:o.length})}}),1===e.length&&""===e[0])s.innerHTML='<div id="no-result"><i class="fa fa-search fa-5x" /></div>';else if(0===o.length)s.innerHTML='<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>';else{o.sort(function(t,e){return t.searchTextCount!==e.searchTextCount?e.searchTextCount-t.searchTextCount:t.hitCount!==e.hitCount?e.hitCount-t.hitCount:e.id-t.id});var a='<ul class="search-result-list">';o.forEach(function(t){a+=t.item}),a+="</ul>",s.innerHTML=a}};r.addEventListener("input",a),$(".local-search-pop-overlay").remove(),$("body").css("overflow",""),proceedsearch()}})};$(".popup-trigger").click(function(t){t.stopPropagation(),isfetched===!1?searchFunc(path,"local-search-input","local-search-result"):proceedsearch()}),$(".popup-btn-close").click(onPopupClose),$(".popup").click(function(t){t.stopPropagation()}),$(document).on("keyup",function(t){var e=27===t.which&&$(".search-popup").is(":visible");e&&onPopupClose()})</script><script src="/js/src/js.cookie.js?v=6.6.0"></script><script src="/js/src/scroll-cookie.js?v=6.6.0"></script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({pluginRootPath:"live2dw/",pluginJsPath:"lib/",pluginModelPath:"assets/",model:{scale:1.2,hHeadPos:.5,vHeadPos:.618,jsonPath:"/live2dw/assets/tororo.model.json"},display:{superSample:2,width:150,height:300,position:"right",hOffset:0,vOffset:-20},mobile:{show:!1,scale:.5},react:{opacityDefault:.7,opacityOnHover:.2},log:!1,tagMode:!1})</script><script>!function(t){function n(){for(var n=0;n<e.length;n++)i=e[n],0<=(o=i.getBoundingClientRect()).top&&0<=o.left&&o.top<=(t.innerHeight||document.documentElement.clientHeight)&&function(t){var i,o,c,r,l=e[n];i=l,o=function(){e=e.filter(function(t){return l!==t})},c=new Image,r=i.getAttribute("data-original"),c.onload=function(){i.src=r,o&&o()},c.src=r}();var i,o}var e=Array.prototype.slice.call(document.querySelectorAll("img[data-original]"));n(),t.addEventListener("scroll",function(){!function(t,n){clearTimeout(t.tId),t.tId=setTimeout(function(){t.call(n)},500)}(n,t)})}(this)</script></body></html><!-- rebuild by neat -->